(()=>{var t={916:(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});const n=i.p+"0cc67b926321b46c35cc929178804e2f.svg"},913:(t,e,i)=>{var n;void 0===(n=function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(){this.isEnvironmentValid=t=>this.environments.includes(t),this.setEnvironment=t=>{t&&this.isEnvironmentValid(t)&&(this.environment=t,t===this.environmentStaging?(this.apiUrl=this.apiUrlStaging,this.eventsUrl=this.eventsUrlStaging):t===this.environmentLocal?(this.apiUrl=this.apiUrlLocal,this.eventsUrl=this.eventsUrlLocal):t===this.environmentProduction&&(this.apiUrl=this.apiUrlProduction,this.eventsUrl=this.eventsUrlProduction))},this.environmentLocal="local",this.environmentStaging="staging",this.environmentProduction="production",this.apiUrl="https://api.tonicpow.com",this.apiUrlLocal="http://localhost:3000",this.apiUrlStaging="https://api.staging.tonicpow.com",this.apiUrlProduction="https://api.tonicpow.com",this.eventsUrl="https://events.tonicpow.com",this.eventsUrlLocal="http://localhost:3002",this.eventsUrlStaging="https://events.staging.tonicpow.com",this.eventsUrlProduction="https://events.tonicpow.com",this.customEnvironment="data-environment",this.environment="",this.environments=[this.environmentLocal,this.environmentStaging,this.environmentProduction],this.maxSessionDays=60,this.sessionName="tncpw_session",this.version="v0.0.8",this.widgetDivClass="tonicpow-widget",this.widgetId="data-widget-id"}}}.apply(e,[i,e]))||(t.exports=n)},242:function(t,e,i){var n,o,s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};n=[i,e,i(913)],void 0===(o=function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i=s(i),e.default=class{constructor(t){this.detectWidgetClick=()=>{document.addEventListener("click",(async t=>{let e=(t||window.event).target?.parentElement?.parentElement;if(e?.classList?.contains("tonicpow-widget"))try{await this.sendEvent("click",e.getAttribute("widget-id")||"")}catch(t){console.error("failed to report interaction: click",t)}}))},this.detectBounce=()=>{window.onbeforeunload=()=>{this.sendEvent("bounce",((new Date).getTime()-this.start).toString())}},this.detectInteraction=()=>{document.addEventListener("mousedown",(async()=>{if(!this.interactionSent)try{await this.sendEvent("interaction","mousedown"),this.interactionSent=!0}catch(t){console.error("failed to report interaction: mousedown",t)}})),document.addEventListener("scroll",(async()=>{if(!this.interactionSent)try{await this.sendEvent("interaction","scroll"),this.interactionSent=!0}catch(t){console.error("failed to report interaction: scroll",t)}})),document.addEventListener("keypress",(async()=>{if(!this.interactionSent)try{await this.sendEvent("interaction","keypress"),this.interactionSent=!0}catch(t){console.error("failed to report interaction: keypress",t)}}))},this.sendEvent=async(t,e)=>{if(!this.sessionId)return void console.info("you must call init with a session before sending events");let n=new i.default,o={v:n.version,name:t,tncpw_session:this.sessionId,data:e};await fetch(`${n.eventsUrl}/v1/events?d=${btoa(JSON.stringify(o))}`,{method:"get"})},this.sessionId=t,this.interactionSent=!1,this.start=(new Date).getTime(),this.detectInteraction(),this.detectBounce(),this.detectWidgetClick()}}}.apply(e,n))||(t.exports=o)},607:function(t,e,i){var n,o,s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};n=[i,e,i(916),i(913),i(242),i(912)],void 0===(o=function(t,e,i,n,o,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i=s(i),n=s(n),o=s(o),r=s(r);class a{constructor(t){this.registerEvents=()=>{if(!this.events){let t=this.getVisitorSession();t&&t.length&&(this.events=new o.default(t))}},this.setOreo=(t,e,i)=>{const n=new Date;n.setTime(n.getTime()+864e5*i),document.cookie=`${t}=${e};path=/;expires=${n.toUTCString()}`},this.captureVisitorSession=(t="")=>{let e=t;return t&&t.length||"undefined"==typeof window||(e=new URLSearchParams(window.location.search).get(this.config.sessionName)||""),e&&e.length>0?(this.setOreo(this.config.sessionName,e,this.config.maxSessionDays),this.storage.setStorage(this.config.sessionName,e,86400*this.config.maxSessionDays),e):null},this.getVisitorSession=()=>this.storage.getStorage(this.config.sessionName),this.loadDivs=async()=>{const t=document.getElementsByClassName(this.config.widgetDivClass);for(let n=t.length-1;n>=0;n--){const o=t[n];if(!o)continue;const s=o.getAttribute(this.config.widgetId);if(!s){console.log(`${s} not found`);continue}const r=o.getAttribute(this.config.customEnvironment);this.config.setEnvironment(r||"production"),this.widgets.set(s,null);try{const t=await fetch(`${this.config.apiUrl}/v1/widgets/display/${s}?provider=embed-${this.config.version}`);var e;403===t.status?(console.info(`${t.status}: Domain not allowed`),e={link_url:"https://tonicpow.com",image_url:i.default}):e=await t.json();const n=encodeURIComponent(e.title);o.innerHTML=`\n      <a href="${e.link_url}?utm_source=tonicpow-widgets&utm_medium=widget&utm_campaign=${s}&utm_content=${n}" style="display: block">\n      <img src="${e.image_url}" \n      id="${s}"\n      width="${e.width}" \n      height="${e.height}" \n      alt="${e.title}" />\n      </a>`,o.setAttribute("data-width",e.width),o.setAttribute("data-height",e.height),this.widgets.set(s,e),this.options&&this.options.widgetsChangedCallback&&(e.id=s,this.options.widgetsChangedCallback(e))}catch(t){throw t}}},this.load=async()=>{if("undefined"==typeof window)return void console.error("TonicPow embed only works in the browser");const t=document.getElementsByClassName(this.config.widgetDivClass);if(t&&t.length>0)try{await this.loadDivs(),console.log("%c TonicPow widget(s) loaded! ","background: #974CD2; color: #fff")}catch(t){throw t}const e=this.captureVisitorSession();e&&(this.events=new o.default(e))},this.config=new n.default,this.storage=new r.default,this.widgets=new Map,this.options=t,"complete"===document.readyState||"interactive"===document.readyState?(this.load(),this.registerEvents()):document.addEventListener("DOMContentLoaded",(()=>{this.load(),this.registerEvents()}))}}e.default=a;var c=new a;window.TonicPow=c||{}}.apply(e,n))||(t.exports=o)},912:(t,e,i)=>{var n;void 0===(n=function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(){this.removeStorage=t=>{try{localStorage.removeItem(t),localStorage.removeItem(`${t}_expiresIn`)}catch(e){return console.log(`removeStorage: Error removing key [${t}] from localStorage: ${JSON.stringify(e)}`),!1}return!0},this.getStorage=t=>{const e=Date.now();let i;try{i=localStorage.getItem(`${t}_expires`)}catch(t){return console.log(`getItem: error getting localStorage: ${JSON.stringify(t)}`),null}if(null==i&&(i=0),i<e)return this.removeStorage(t),null;try{return localStorage.getItem(t)}catch(e){return console.log(`getStorage: Error reading key [${t}] from localStorage: ${JSON.stringify(e)}`),null}},this.setStorage=(t,e,i=null)=>{i=i?Math.abs(i):86400;const n=Date.now()+1e3*i;try{localStorage.setItem(t,e),localStorage.setItem(`${t}_expires`,n.toString())}catch(e){return console.log(`setStorage: Error setting key [${t}] in localStorage: ${JSON.stringify(e)}`),!1}return!0}}}}.apply(e,[i,e]))||(t.exports=n)}},e={};function i(n){if(e[n])return e[n].exports;var o=e[n]={exports:{}};return t[n].call(o.exports,o,o.exports,i),o.exports}i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t;i.g.importScripts&&(t=i.g.location+"");var e=i.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var n=e.getElementsByTagName("script");n.length&&(t=n[n.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=t})(),i(607)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9AdG9uaWNwb3cvd2lkZ2V0Ly4vc3JjL2Fzc2V0cy9pbWFnZV9wbGFjZWhvbGRlcl90b25pY3Bvd19zcXVhcmUuc3ZnIiwid2VicGFjazovL0B0b25pY3Bvdy93aWRnZXQvLi9zcmMvY29uZmlnLnRzIiwid2VicGFjazovL0B0b25pY3Bvdy93aWRnZXQvLi9zcmMvZXZlbnRzLnRzIiwid2VicGFjazovL0B0b25pY3Bvdy93aWRnZXQvLi9zcmMvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vQHRvbmljcG93L3dpZGdldC8uL3NyYy9zdG9yYWdlLnRzIiwid2VicGFjazovL0B0b25pY3Bvdy93aWRnZXQvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vQHRvbmljcG93L3dpZGdldC93ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMiLCJ3ZWJwYWNrOi8vQHRvbmljcG93L3dpZGdldC93ZWJwYWNrL3J1bnRpbWUvZ2xvYmFsIiwid2VicGFjazovL0B0b25pY3Bvdy93aWRnZXQvd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly9AdG9uaWNwb3cvd2lkZ2V0L3dlYnBhY2svcnVudGltZS9tYWtlIG5hbWVzcGFjZSBvYmplY3QiLCJ3ZWJwYWNrOi8vQHRvbmljcG93L3dpZGdldC93ZWJwYWNrL3J1bnRpbWUvcHVibGljUGF0aCIsIndlYnBhY2s6Ly9AdG9uaWNwb3cvd2lkZ2V0L3dlYnBhY2svc3RhcnR1cCJdLCJuYW1lcyI6WyJpc0Vudmlyb25tZW50VmFsaWQiLCJlbnZpcm9ubWVudCIsInRoaXMiLCJlbnZpcm9ubWVudHMiLCJpbmNsdWRlcyIsInNldEVudmlyb25tZW50IiwiZW52aXJvbm1lbnRTdGFnaW5nIiwiYXBpVXJsIiwiYXBpVXJsU3RhZ2luZyIsImV2ZW50c1VybCIsImV2ZW50c1VybFN0YWdpbmciLCJlbnZpcm9ubWVudExvY2FsIiwiYXBpVXJsTG9jYWwiLCJldmVudHNVcmxMb2NhbCIsImVudmlyb25tZW50UHJvZHVjdGlvbiIsImFwaVVybFByb2R1Y3Rpb24iLCJldmVudHNVcmxQcm9kdWN0aW9uIiwiY3VzdG9tRW52aXJvbm1lbnQiLCJtYXhTZXNzaW9uRGF5cyIsInNlc3Npb25OYW1lIiwidmVyc2lvbiIsIndpZGdldERpdkNsYXNzIiwid2lkZ2V0SWQiLCJzZXNzaW9uSWQiLCJkZXRlY3RXaWRnZXRDbGljayIsImRvY3VtZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsImFzeW5jIiwiZSIsImNvbnRhaW5lciIsIndpbmRvdyIsImV2ZW50IiwidGFyZ2V0IiwicGFyZW50RWxlbWVudCIsImNsYXNzTGlzdCIsImNvbnRhaW5zIiwic2VuZEV2ZW50IiwiZ2V0QXR0cmlidXRlIiwiY29uc29sZSIsImVycm9yIiwiZGV0ZWN0Qm91bmNlIiwib25iZWZvcmV1bmxvYWQiLCJEYXRlIiwiZ2V0VGltZSIsInN0YXJ0IiwidG9TdHJpbmciLCJkZXRlY3RJbnRlcmFjdGlvbiIsImludGVyYWN0aW9uU2VudCIsImV2ZW50TmFtZSIsImRhdGEiLCJpbmZvIiwiY29uZmlnIiwicGF5bG9hZCIsInYiLCJuYW1lIiwidG5jcHdfc2Vzc2lvbiIsImZldGNoIiwiYnRvYSIsIkpTT04iLCJzdHJpbmdpZnkiLCJtZXRob2QiLCJUb25pY1BvdyIsIm9wdGlvbnMiLCJyZWdpc3RlckV2ZW50cyIsImV2ZW50cyIsInNlc3Npb24iLCJnZXRWaXNpdG9yU2Vzc2lvbiIsImxlbmd0aCIsInNldE9yZW8iLCJ2YWx1ZSIsImRheXMiLCJkYXRlIiwic2V0VGltZSIsImNvb2tpZSIsInRvVVRDU3RyaW5nIiwiY2FwdHVyZVZpc2l0b3JTZXNzaW9uIiwiY3VzdG9tU2Vzc2lvbklkIiwiVVJMU2VhcmNoUGFyYW1zIiwibG9jYXRpb24iLCJzZWFyY2giLCJnZXQiLCJzdG9yYWdlIiwic2V0U3RvcmFnZSIsImdldFN0b3JhZ2UiLCJsb2FkRGl2cyIsInRvbmljRGl2cyIsImdldEVsZW1lbnRzQnlDbGFzc05hbWUiLCJpIiwidG9uaWNEaXYiLCJsb2ciLCJ3aWRnZXRzIiwic2V0IiwicHJvbWlzZSIsInJlc3BvbnNlIiwic3RhdHVzIiwibGlua191cmwiLCJpbWFnZV91cmwiLCJqc29uIiwiY2FtcGFpZ25UaXRsZSIsImVuY29kZVVSSUNvbXBvbmVudCIsInRpdGxlIiwiaW5uZXJIVE1MIiwid2lkdGgiLCJoZWlnaHQiLCJzZXRBdHRyaWJ1dGUiLCJ3aWRnZXRzQ2hhbmdlZENhbGxiYWNrIiwiaWQiLCJsb2FkIiwiTWFwIiwicmVhZHlTdGF0ZSIsInRwb3ciLCJyZW1vdmVTdG9yYWdlIiwibG9jYWxTdG9yYWdlIiwicmVtb3ZlSXRlbSIsImtleSIsIm5vdyIsImV4cGlyZXMiLCJnZXRJdGVtIiwiTWF0aCIsImFicyIsInNjaGVkdWxlIiwic2V0SXRlbSIsIl9fd2VicGFja19tb2R1bGVfY2FjaGVfXyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJfX3dlYnBhY2tfbW9kdWxlc19fIiwiY2FsbCIsImQiLCJkZWZpbml0aW9uIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImciLCJnbG9iYWxUaGlzIiwiRnVuY3Rpb24iLCJvYmoiLCJwcm9wIiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJzY3JpcHRVcmwiLCJpbXBvcnRTY3JpcHRzIiwiY3VycmVudFNjcmlwdCIsInNyYyIsInNjcmlwdHMiLCJnZXRFbGVtZW50c0J5VGFnTmFtZSIsIkVycm9yIiwicmVwbGFjZSIsInAiXSwibWFwcGluZ3MiOiJzRUFBQSxRQUFlLElBQTBCLHdDLDRHQ0F6QyxnQkFxQkUsY0F3QkEsS0FBQUEsbUJBQXNCQyxHQUF3QkMsS0FBS0MsYUFBYUMsU0FBU0gsR0FHekUsS0FBQUksZUFBa0JKLElBRVhBLEdBS0FDLEtBQUtGLG1CQUFtQkMsS0FLN0JDLEtBQUtELFlBQWNBLEVBR2ZBLElBQWdC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dkQsSUFBSTRFLEVBQ0F0QixFQUFvQlksRUFBRVcsZ0JBQWVELEVBQVl0QixFQUFvQlksRUFBRXpELFNBQVcsSUFDdEYsSUFBSXJELEVBQVdrRyxFQUFvQlksRUFBRTlHLFNBQ3JDLElBQUt3SCxHQUFheEgsSUFDYkEsRUFBUzBILGdCQUNaRixFQUFZeEgsRUFBUzBILGNBQWNDLE1BQy9CSCxHQUFXLENBQ2YsSUFBSUksRUFBVTVILEVBQVM2SCxxQkFBcUIsVUFDekNELEVBQVFsRixTQUFROEUsRUFBWUksRUFBUUEsRUFBUWxGLE9BQVMsR0FBR2lGLEtBSzdELElBQUtILEVBQVcsTUFBTSxJQUFJTSxNQUFNLHlEQUNoQ04sRUFBWUEsRUFBVU8sUUFBUSxPQUFRLElBQUlBLFFBQVEsUUFBUyxJQUFJQSxRQUFRLFlBQWEsS0FDcEY3QixFQUFvQjhCLEVBQUlSLEcsR0NaRXRCLEVBQW9CLE0iLCJmaWxlIjoidG9uaWNwb3cuanMiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBfX3dlYnBhY2tfcHVibGljX3BhdGhfXyArIFwiMGNjNjdiOTI2MzIxYjQ2YzM1Y2M5MjkxNzg4MDRlMmYuc3ZnXCI7IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ29uZmlnIHtcclxuICBlbnZpcm9ubWVudExvY2FsOiBzdHJpbmdcclxuICBlbnZpcm9ubWVudFN0YWdpbmc6IHN0cmluZ1xyXG4gIGVudmlyb25tZW50UHJvZHVjdGlvbjogc3RyaW5nXHJcbiAgYXBpVXJsOiBzdHJpbmdcclxuICBhcGlVcmxMb2NhbDogc3RyaW5nXHJcbiAgYXBpVXJsU3RhZ2luZzogc3RyaW5nXHJcbiAgYXBpVXJsUHJvZHVjdGlvbjogc3RyaW5nXHJcbiAgZXZlbnRzVXJsOiBzdHJpbmdcclxuICBldmVudHNVcmxMb2NhbDogc3RyaW5nXHJcbiAgZXZlbnRzVXJsU3RhZ2luZzogc3RyaW5nXHJcbiAgZXZlbnRzVXJsUHJvZHVjdGlvbjogc3RyaW5nXHJcbiAgY3VzdG9tRW52aXJvbm1lbnQ6IHN0cmluZ1xyXG4gIGVudmlyb25tZW50OiBzdHJpbmdcclxuICBlbnZpcm9ubWVudHM6IHN0cmluZ1tdXHJcbiAgbWF4U2Vzc2lvbkRheXM6IG51bWJlclxyXG4gIHNlc3Npb25OYW1lOiBzdHJpbmdcclxuICB2ZXJzaW9uOiBzdHJpbmdcclxuICB3aWRnZXREaXZDbGFzczogc3RyaW5nXHJcbiAgd2lkZ2V0SWQ6IHN0cmluZ1xyXG5cclxuICBjb25zdHJ1Y3RvcigpIHtcclxuICAgIHRoaXMuZW52aXJvbm1lbnRMb2NhbCA9ICdsb2NhbCdcclxuICAgIHRoaXMuZW52aXJvbm1lbnRTdGFnaW5nID0gJ3N0YWdpbmcnXHJcbiAgICB0aGlzLmVudmlyb25tZW50UHJvZHVjdGlvbiA9ICdwcm9kdWN0aW9uJ1xyXG5cclxuICAgIHRoaXMuYXBpVXJsID0gJ2h0dHBzOi8vYXBpLnRvbmljcG93LmNvbSdcclxuICAgIHRoaXMuYXBpVXJsTG9jYWwgPSAnaHR0cDovL2xvY2FsaG9zdDozMDAwJ1xyXG4gICAgdGhpcy5hcGlVcmxTdGFnaW5nID0gJ2h0dHBzOi8vYXBpLnN0YWdpbmcudG9uaWNwb3cuY29tJ1xyXG4gICAgdGhpcy5hcGlVcmxQcm9kdWN0aW9uID0gJ2h0dHBzOi8vYXBpLnRvbmljcG93LmNvbSdcclxuICAgIHRoaXMuZXZlbnRzVXJsID0gJ2h0dHBzOi8vZXZlbnRzLnRvbmljcG93LmNvbSdcclxuICAgIHRoaXMuZXZlbnRzVXJsTG9jYWwgPSAnaHR0cDovL2xvY2FsaG9zdDozMDAyJ1xyXG4gICAgdGhpcy5ldmVudHNVcmxTdGFnaW5nID0gJ2h0dHBzOi8vZXZlbnRzLnN0YWdpbmcudG9uaWNwb3cuY29tJ1xyXG4gICAgdGhpcy5ldmVudHNVcmxQcm9kdWN0aW9uID0gJ2h0dHBzOi8vZXZlbnRzLnRvbmljcG93LmNvbSdcclxuICAgIHRoaXMuY3VzdG9tRW52aXJvbm1lbnQgPSAnZGF0YS1lbnZpcm9ubWVudCdcclxuICAgIHRoaXMuZW52aXJvbm1lbnQgPSAnJ1xyXG4gICAgdGhpcy5lbnZpcm9ubWVudHMgPSBbdGhpcy5lbnZpcm9ubWVudExvY2FsLCB0aGlzLmVudmlyb25tZW50U3RhZ2luZywgdGhpcy5lbnZpcm9ubWVudFByb2R1Y3Rpb25dXHJcbiAgICB0aGlzLm1heFNlc3Npb25EYXlzID0gNjBcclxuICAgIHRoaXMuc2Vzc2lvbk5hbWUgPSAndG5jcHdfc2Vzc2lvbidcclxuICAgIHRoaXMudmVyc2lvbiA9ICd2MC4wLjgnXHJcbiAgICB0aGlzLndpZGdldERpdkNsYXNzID0gJ3RvbmljcG93LXdpZGdldCdcclxuICAgIHRoaXMud2lkZ2V0SWQgPSAnZGF0YS13aWRnZXQtaWQnXHJcbiAgfVxyXG5cclxuICAvLyBpc0Vudmlyb25tZW50VmFsaWQgd2lsbCBjaGVjayBpZiB0aGUgZ2l2ZW4gZW52aXJvbm1lbnQgaXMgdmFsaWRcclxuICBpc0Vudmlyb25tZW50VmFsaWQgPSAoZW52aXJvbm1lbnQ6IHN0cmluZykgPT4gdGhpcy5lbnZpcm9ubWVudHMuaW5jbHVkZXMoZW52aXJvbm1lbnQpXHJcblxyXG4gIC8vIHNldEVudmlyb25tZW50IHdpbGwgc2V0IHRoZSBlbnZpcm9ubWVudFxyXG4gIHNldEVudmlyb25tZW50ID0gKGVudmlyb25tZW50OiBzdHJpbmcpID0+IHtcclxuICAgIC8vIE5vIGVudmlyb25tZW50IHNldD8gdXNlIHRoZSBkZWZhdWx0XHJcbiAgICBpZiAoIWVudmlyb25tZW50KSB7XHJcbiAgICAgIHJldHVyblxyXG4gICAgfVxyXG5cclxuICAgIC8vIE5vdCBhIHZhbGlkIGVudmlyb25tZW50P1xyXG4gICAgaWYgKCF0aGlzLmlzRW52aXJvbm1lbnRWYWxpZChlbnZpcm9ubWVudCkpIHtcclxuICAgICAgcmV0dXJuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gU2V0IHRoZSBlbnZpcm9ubWVudFxyXG4gICAgdGhpcy5lbnZpcm9ubWVudCA9IGVudmlyb25tZW50XHJcblxyXG4gICAgLy8gU2V0IHRoZSBBUEkgdXJsXHJcbiAgICBpZiAoZW52aXJvbm1lbnQgPT09IHRoaXMuZW52aXJvbm1lbnRTdGFnaW5nKSB7XHJcbiAgICAgIHRoaXMuYXBpVXJsID0gdGhpcy5hcGlVcmxTdGFnaW5nXHJcbiAgICAgIHRoaXMuZXZlbnRzVXJsID0gdGhpcy5ldmVudHNVcmxTdGFnaW5nXHJcbiAgICB9IGVsc2UgaWYgKGVudmlyb25tZW50ID09PSB0aGlzLmVudmlyb25tZW50TG9jYWwpIHtcclxuICAgICAgdGhpcy5hcGlVcmwgPSB0aGlzLmFwaVVybExvY2FsXHJcbiAgICAgIHRoaXMuZXZlbnRzVXJsID0gdGhpcy5ldmVudHNVcmxMb2NhbFxyXG4gICAgfSBlbHNlIGlmIChlbnZpcm9ubWVudCA9PT0gdGhpcy5lbnZpcm9ubWVudFByb2R1Y3Rpb24pIHtcclxuICAgICAgdGhpcy5hcGlVcmwgPSB0aGlzLmFwaVVybFByb2R1Y3Rpb25cclxuICAgICAgdGhpcy5ldmVudHNVcmwgPSB0aGlzLmV2ZW50c1VybFByb2R1Y3Rpb25cclxuICAgIH1cclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IENvbmZpZyBmcm9tICcuL2NvbmZpZydcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEV2ZW50cyB7XHJcbiAgc2Vzc2lvbklkOiBzdHJpbmdcclxuICBzdGFydDogbnVtYmVyXHJcbiAgaW50ZXJhY3Rpb25TZW50OiBib29sZWFuXHJcblxyXG4gIGNvbnN0cnVjdG9yKHNlc3Npb25JZDogc3RyaW5nKSB7XHJcbiAgICAvLyBTZXQgdGhlIGN1cnJlbnQgc2Vzc2lvblxyXG4gICAgdGhpcy5zZXNzaW9uSWQgPSBzZXNzaW9uSWRcclxuXHJcbiAgICB0aGlzLmludGVyYWN0aW9uU2VudCA9IGZhbHNlXHJcblxyXG4gICAgLy8gUmVtZW1iZXIgd2hlbiB3ZSBzdGFydGVkXHJcbiAgICB0aGlzLnN0YXJ0ID0gbmV3IERhdGUoKS5nZXRUaW1lKClcclxuICAgIHRoaXMuZGV0ZWN0SW50ZXJhY3Rpb24oKVxyXG4gICAgdGhpcy5kZXRlY3RCb3VuY2UoKVxyXG4gICAgdGhpcy5kZXRlY3RXaWRnZXRDbGljaygpXHJcbiAgfVxyXG5cclxuICAvLyBEZXRlY3RzIGNsaWNrIG9uIHRoZSB3aWRnZXRcclxuICBkZXRlY3RXaWRnZXRDbGljayA9ICgpID0+IHtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgKGU6IEV2ZW50KSA9PiB7XHJcbiAgICAgIC8vIEdldCB0aGUgY2xpY2sgdGFyZ2V0XHJcbiAgICAgIHZhciB0YXJnZXQgPSAoZSB8fCB3aW5kb3cuZXZlbnQpLnRhcmdldCBhcyBIVE1MRGl2RWxlbWVudFxyXG5cclxuICAgICAgLy8gR2V0IHRoZSB3aWRnZXQgY29udGFpbmVyXHJcbiAgICAgIGxldCBjb250YWluZXIgPSB0YXJnZXQ/LnBhcmVudEVsZW1lbnQ/LnBhcmVudEVsZW1lbnRcclxuXHJcbiAgICAgIC8vIFNlbmQgZXZlbnQgb25seSBpZiB3aWRnZXQgd2FzIGNsaWNrZWRcclxuICAgICAgaWYgKGNvbnRhaW5lcj8uY2xhc3NMaXN0Py5jb250YWlucygndG9uaWNwb3ctd2lkZ2V0JykpIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgYXdhaXQgdGhpcy5zZW5kRXZlbnQoJ2NsaWNrJywgY29udGFpbmVyLmdldEF0dHJpYnV0ZSgnd2lkZ2V0LWlkJykgfHwgJycpXHJcbiAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgY29uc29sZS5lcnJvcignZmFpbGVkIHRvIHJlcG9ydCBpbnRlcmFjdGlvbjogY2xpY2snLCBlKVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIC8vIERldGVjdHMgYSBib3VuY2UgZXZlbnRcclxuICBkZXRlY3RCb3VuY2UgPSAoKSA9PiB7XHJcbiAgICB3aW5kb3cub25iZWZvcmV1bmxvYWQgPSAoKSA9PiB7XHJcbiAgICAgIC8vIENhbGN1bGF0ZSB0aW1lIG9uIHBhZ2VcclxuICAgICAgdGhpcy5zZW5kRXZlbnQoJ2JvdW5jZScsIChuZXcgRGF0ZSgpLmdldFRpbWUoKSAtIHRoaXMuc3RhcnQpLnRvU3RyaW5nKCkpXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBEZXRlY3RzIGEgcGFnZSBpbnRlcmFjdGlvblxyXG4gIGRldGVjdEludGVyYWN0aW9uID0gKCkgPT4ge1xyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBpZiAoIXRoaXMuaW50ZXJhY3Rpb25TZW50KSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgIGF3YWl0IHRoaXMuc2VuZEV2ZW50KCdpbnRlcmFjdGlvbicsICdtb3VzZWRvd24nKVxyXG4gICAgICAgICAgdGhpcy5pbnRlcmFjdGlvblNlbnQgPSB0cnVlXHJcbiAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgY29uc29sZS5lcnJvcignZmFpbGVkIHRvIHJlcG9ydCBpbnRlcmFjdGlvbjogbW91c2Vkb3duJywgZSlcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pXHJcblxyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBpZiAoIXRoaXMuaW50ZXJhY3Rpb25TZW50KSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgIGF3YWl0IHRoaXMuc2VuZEV2ZW50KCdpbnRlcmFjdGlvbicsICdzY3JvbGwnKVxyXG4gICAgICAgICAgdGhpcy5pbnRlcmFjdGlvblNlbnQgPSB0cnVlXHJcbiAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgY29uc29sZS5lcnJvcignZmFpbGVkIHRvIHJlcG9ydCBpbnRlcmFjdGlvbjogc2Nyb2xsJywgZSlcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pXHJcblxyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5cHJlc3MnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGlmICghdGhpcy5pbnRlcmFjdGlvblNlbnQpIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgYXdhaXQgdGhpcy5zZW5kRXZlbnQoJ2ludGVyYWN0aW9uJywgJ2tleXByZXNzJylcclxuICAgICAgICAgIHRoaXMuaW50ZXJhY3Rpb25TZW50ID0gdHJ1ZVxyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ2ZhaWxlZCB0byByZXBvcnQgaW50ZXJhY3Rpb246IGtleXByZXNzJywgZSlcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICAvLyBTZW5kIGV2ZW50IHdpbGwgc2VuZCBhbiBldmVudCB0byBUb25pY1Bvd1xyXG4gIHNlbmRFdmVudCA9IGFzeW5jIChldmVudE5hbWU6IHN0cmluZywgZGF0YTogc3RyaW5nKSA9PiB7XHJcbiAgICBpZiAoIXRoaXMuc2Vzc2lvbklkKSB7XHJcbiAgICAgIGNvbnNvbGUuaW5mbygneW91IG11c3QgY2FsbCBpbml0IHdpdGggYSBzZXNzaW9uIGJlZm9yZSBzZW5kaW5nIGV2ZW50cycpXHJcbiAgICAgIHJldHVyblxyXG4gICAgfVxyXG5cclxuICAgIC8vIEdldCBjb25maWdcclxuICAgIGxldCBjb25maWcgPSBuZXcgQ29uZmlnKClcclxuXHJcbiAgICAvLyBQYWNrYWdlIHBheWxvYWRcclxuICAgIGxldCBwYXlsb2FkID0ge1xyXG4gICAgICB2OiBjb25maWcudmVyc2lvbixcclxuICAgICAgbmFtZTogZXZlbnROYW1lLFxyXG4gICAgICB0bmNwd19zZXNzaW9uOiB0aGlzLnNlc3Npb25JZCxcclxuICAgICAgZGF0YSxcclxuICAgIH1cclxuXHJcbiAgICBhd2FpdCBmZXRjaChgJHtjb25maWcuZXZlbnRzVXJsfS92MS9ldmVudHM/ZD0ke2J0b2EoSlNPTi5zdHJpbmdpZnkocGF5bG9hZCkpfWAsIHtcclxuICAgICAgbWV0aG9kOiAnZ2V0JyxcclxuICAgIH0pXHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBmYWxsYmFja0ltYWdlIGZyb20gJy4vYXNzZXRzL2ltYWdlX3BsYWNlaG9sZGVyX3RvbmljcG93X3NxdWFyZS5zdmcnXHJcbmltcG9ydCBDb25maWcgZnJvbSAnLi9jb25maWcnXHJcbmltcG9ydCBFdmVudHMgZnJvbSAnLi9ldmVudHMnXHJcbmltcG9ydCBTdG9yYWdlIGZyb20gJy4vc3RvcmFnZSdcclxuaW1wb3J0IFdpZGdldCBmcm9tICcuL3R5cGVzJ1xyXG5cclxuaW50ZXJmYWNlIFRvbmljUG93T3B0aW9ucyB7XHJcbiAgd2lkZ2V0c0NoYW5nZWRDYWxsYmFjazogKHdpZGdldDogdHlwZW9mIFdpZGdldCkgPT4gdm9pZFxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBUb25pY1BvdyB7XHJcbiAgY29uZmlnOiBDb25maWdcclxuICBzdG9yYWdlOiBTdG9yYWdlXHJcbiAgZXZlbnRzOiBFdmVudHMgfCB1bmRlZmluZWRcclxuICB3aWRnZXRzOiBNYXA8U3RyaW5nLCB0eXBlb2YgV2lkZ2V0IHwgbnVsbD5cclxuICBvcHRpb25zOiBUb25pY1Bvd09wdGlvbnMgfCB1bmRlZmluZWRcclxuXHJcbiAgY29uc3RydWN0b3Iob3B0aW9ucz86IFRvbmljUG93T3B0aW9ucykge1xyXG4gICAgLy8gU2V0IG5hbWVzcGFjZXNcclxuICAgIHRoaXMuY29uZmlnID0gbmV3IENvbmZpZygpXHJcbiAgICB0aGlzLnN0b3JhZ2UgPSBuZXcgU3RvcmFnZSgpXHJcbiAgICB0aGlzLndpZGdldHMgPSBuZXcgTWFwPFN0cmluZywgdHlwZW9mIFdpZGdldD4oKVxyXG4gICAgdGhpcy5vcHRpb25zID0gb3B0aW9uc1xyXG5cclxuICAgIC8vIFN0YXJ0IHRoZSBUb25pY1BvdyBzZXJ2aWNlIGFuZCBsb2FkIG1vZHVsZXNcclxuXHJcbiAgICAvLyBMb2FkIHRoZSBUb25pY1BvdyB3aWRnZXQgd2hlbiBET00gaXMgcmVhZHlcclxuICAgIGlmIChkb2N1bWVudC5yZWFkeVN0YXRlID09PSAnY29tcGxldGUnIHx8IGRvY3VtZW50LnJlYWR5U3RhdGUgPT09ICdpbnRlcmFjdGl2ZScpIHtcclxuICAgICAgLy8gVGhpcyBsb2FkcyBpZiB0aGUgPHNjcmlwdD4gaXMgZHluYW1pY2FsbHkgaW5qZWN0ZWQgaW50byB0aGUgcGFnZVxyXG4gICAgICB0aGlzLmxvYWQoKVxyXG4gICAgICB0aGlzLnJlZ2lzdGVyRXZlbnRzKClcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIC8vIFRoaXMgbG9hZHMgaWYgdGhlIDxzY3JpcHQ+IGlzIGhhcmRjb2RlZCBpbiB0aGUgaHRtbCBwYWdlIGluIHRoZSA8aGVhZD5cclxuICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsICgpID0+IHtcclxuICAgICAgICB0aGlzLmxvYWQoKVxyXG4gICAgICAgIHRoaXMucmVnaXN0ZXJFdmVudHMoKVxyXG4gICAgICB9KVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gcmVnaXN0ZXJFdmVudHMgLVJlZ2lzdGVycyBldmVudCBsaXN0ZW5lcnMuIFJ1bnMgb25seSBvbmNlXHJcbiAgcmVnaXN0ZXJFdmVudHMgPSAoKSA9PiB7XHJcbiAgICBpZiAoIXRoaXMuZXZlbnRzKSB7XHJcbiAgICAgIC8vIFJlZ2lzdGVyIGV2ZW50cyBpZiB3ZSBoYXZlIGEgdmFsaWQgc2Vzc2lvblxyXG4gICAgICBsZXQgc2Vzc2lvbiA9IHRoaXMuZ2V0VmlzaXRvclNlc3Npb24oKVxyXG4gICAgICAvLyBUT0RPOiBWYWxpZGF0ZSBzZXNzaW9uIGhlcmVcclxuICAgICAgaWYgKHNlc3Npb24gJiYgc2Vzc2lvbi5sZW5ndGgpIHtcclxuICAgICAgICB0aGlzLmV2ZW50cyA9IG5ldyBFdmVudHMoc2Vzc2lvbilcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gc2V0T3JlbyBmb3IgY3JlYXRpbmcgbmV3IG9yZW9zXHJcbiAgc2V0T3JlbyA9IChuYW1lOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcsIGRheXM6IG51bWJlcikgPT4ge1xyXG4gICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKClcclxuICAgIGRhdGUuc2V0VGltZShkYXRlLmdldFRpbWUoKSArIDI0ICogNjAgKiA2MCAqIDEwMDAgKiBkYXlzKVxyXG4gICAgZG9jdW1lbnQuY29va2llID0gYCR7bmFtZX09JHt2YWx1ZX07cGF0aD0vO2V4cGlyZXM9JHtkYXRlLnRvVVRDU3RyaW5nKCl9YFxyXG4gIH1cclxuXHJcbiAgLy8gY2FwdHVyZVZpc2l0b3JTZXNzaW9uIHdpbGwgY2FwdHVyZSB0aGUgc2Vzc2lvbiBhbmQgc3RvcmUgaXRcclxuICAvLyBCdWlsZHMgYSBjb29raWUgc28gaXQncyBzZW50IG9uIHJlcXVlc3RzIGF1dG9tYXRpY2FsbHlcclxuICAvLyBTdG9yZXMgaW4gbG9jYWwgc3RvcmFnZSBmb3IgZWFzeSBhY2Nlc3MgZnJvbSB0aGUgYXBwbGljYXRpb25cclxuICBjYXB0dXJlVmlzaXRvclNlc3Npb24gPSAoY3VzdG9tU2Vzc2lvbklkOiBzdHJpbmcgPSAnJykgPT4ge1xyXG4gICAgbGV0IHNlc3Npb25JZCA9IGN1c3RvbVNlc3Npb25JZFxyXG5cclxuICAgIGlmICgoIWN1c3RvbVNlc3Npb25JZCB8fCAhY3VzdG9tU2Vzc2lvbklkLmxlbmd0aCkgJiYgdHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICAgY29uc3QgdXJsUGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcyh3aW5kb3cubG9jYXRpb24uc2VhcmNoKVxyXG4gICAgICBzZXNzaW9uSWQgPSB1cmxQYXJhbXMuZ2V0KHRoaXMuY29uZmlnLnNlc3Npb25OYW1lKSB8fCAnJ1xyXG4gICAgfVxyXG4gICAgaWYgKHNlc3Npb25JZCAmJiBzZXNzaW9uSWQubGVuZ3RoID4gMCkge1xyXG4gICAgICB0aGlzLnNldE9yZW8odGhpcy5jb25maWcuc2Vzc2lvbk5hbWUsIHNlc3Npb25JZCwgdGhpcy5jb25maWcubWF4U2Vzc2lvbkRheXMpXHJcbiAgICAgIHRoaXMuc3RvcmFnZS5zZXRTdG9yYWdlKFxyXG4gICAgICAgIHRoaXMuY29uZmlnLnNlc3Npb25OYW1lLFxyXG4gICAgICAgIHNlc3Npb25JZCxcclxuICAgICAgICAyNCAqIDYwICogNjAgKiB0aGlzLmNvbmZpZy5tYXhTZXNzaW9uRGF5c1xyXG4gICAgICApXHJcbiAgICAgIHJldHVybiBzZXNzaW9uSWRcclxuICAgIH1cclxuICAgIHJldHVybiBudWxsXHJcbiAgfVxyXG5cclxuICAvLyBnZXRWaXNpdG9yU2Vzc2lvbiB3aWxsIGdldCB0aGUgc2Vzc2lvbiBpZiBpdCBleGlzdHNcclxuICBnZXRWaXNpdG9yU2Vzc2lvbiA9ICgpID0+IHRoaXMuc3RvcmFnZS5nZXRTdG9yYWdlKHRoaXMuY29uZmlnLnNlc3Npb25OYW1lKVxyXG5cclxuICAvLyBsb2FkRGl2cyByZXBsYWNlcyBlYWNoIFRvbmljUG93IGRpdiB3aXRoIGEgY29ycmVzcG9uZGluZyBlbWJlZCB3aWRnZXRcclxuICBsb2FkRGl2cyA9IGFzeW5jICgpID0+IHtcclxuICAgIC8vIEdldCBhbGwgZGl2c1xyXG4gICAgY29uc3QgdG9uaWNEaXZzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSh0aGlzLmNvbmZpZy53aWRnZXREaXZDbGFzcylcclxuXHJcbiAgICAvLyBMb29wIGFsbCBkaXZzIHRoYXQgd2UgZm91bmRcclxuICAgIGZvciAobGV0IGkgPSB0b25pY0RpdnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcclxuICAgICAgLy8gU2V0IHRoZSBkaXZcclxuICAgICAgY29uc3QgdG9uaWNEaXYgPSB0b25pY0RpdnNbaV0gYXMgSFRNTERpdkVsZW1lbnRcclxuXHJcbiAgICAgIC8vIE5vdCBzdXJlIHdoeSB0aGlzIGlzIG5lZWRlZCBidXQgZW5jb3VudGVyZWQgdGhpcyBpbiBwcm9kIDMvNS8yMDIxIC0gbHVrZVxyXG4gICAgICBpZiAoIXRvbmljRGl2KSB7XHJcbiAgICAgICAgY29udGludWVcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gR2V0IHRoZSB3aWRnZXQgaWRcclxuICAgICAgY29uc3Qgd2lkZ2V0SWQgPSB0b25pY0Rpdi5nZXRBdHRyaWJ1dGUodGhpcy5jb25maWcud2lkZ2V0SWQpXHJcbiAgICAgIGlmICghd2lkZ2V0SWQpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhgJHt3aWRnZXRJZH0gbm90IGZvdW5kYClcclxuICAgICAgICBjb250aW51ZVxyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBHZXQgdGhlIGN1c3RvbSBlbnZpcm9ubWVudCAoc3dpdGNoaW5nIGF3YXkgZnJvbSBkZWZhdWx0OiBwcm9kdWN0aW9uKVxyXG4gICAgICBjb25zdCBjdXN0b21FbnZpcm9ubWVudCA9IHRvbmljRGl2LmdldEF0dHJpYnV0ZSh0aGlzLmNvbmZpZy5jdXN0b21FbnZpcm9ubWVudClcclxuICAgICAgdGhpcy5jb25maWcuc2V0RW52aXJvbm1lbnQoY3VzdG9tRW52aXJvbm1lbnQgfHwgJ3Byb2R1Y3Rpb24nKVxyXG5cclxuICAgICAgLy8gQWRkIHRvIHdpZGdldHMgbWFwXHJcbiAgICAgIHRoaXMud2lkZ2V0cy5zZXQod2lkZ2V0SWQsIG51bGwpXHJcblxyXG4gICAgICB0cnkge1xyXG4gICAgICAgIC8vIEZpcmUgdGhlIHJlcXVlc3QgdG8gbG9hZCB0aGUgd2lkZ2V0IGRhdGFcclxuICAgICAgICBjb25zdCBwcm9taXNlID0gYXdhaXQgZmV0Y2goXHJcbiAgICAgICAgICBgJHt0aGlzLmNvbmZpZy5hcGlVcmx9L3YxL3dpZGdldHMvZGlzcGxheS8ke3dpZGdldElkfT9wcm92aWRlcj1lbWJlZC0ke3RoaXMuY29uZmlnLnZlcnNpb259YFxyXG4gICAgICAgIClcclxuXHJcbiAgICAgICAgdmFyIHJlc3BvbnNlXHJcbiAgICAgICAgaWYgKHByb21pc2Uuc3RhdHVzID09PSA0MDMpIHtcclxuICAgICAgICAgIGNvbnNvbGUuaW5mbyhgJHtwcm9taXNlLnN0YXR1c306IERvbWFpbiBub3QgYWxsb3dlZGApXHJcbiAgICAgICAgICByZXNwb25zZSA9IHtcclxuICAgICAgICAgICAgbGlua191cmw6ICdodHRwczovL3RvbmljcG93LmNvbScsXHJcbiAgICAgICAgICAgIGltYWdlX3VybDogZmFsbGJhY2tJbWFnZSxcclxuICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgcmVzcG9uc2UgPSBhd2FpdCBwcm9taXNlLmpzb24oKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gU2V0IFVSSSBlbmNvZGVkIHRpdGxlXHJcbiAgICAgICAgY29uc3QgY2FtcGFpZ25UaXRsZSA9IGVuY29kZVVSSUNvbXBvbmVudChyZXNwb25zZS50aXRsZSlcclxuXHJcbiAgICAgICAgLy8gU2V0IHRoZSBIVE1MXHJcbiAgICAgICAgdG9uaWNEaXYuaW5uZXJIVE1MID0gYFxyXG4gICAgICA8YSBocmVmPVwiJHtyZXNwb25zZS5saW5rX3VybH0/dXRtX3NvdXJjZT10b25pY3Bvdy13aWRnZXRzJnV0bV9tZWRpdW09d2lkZ2V0JnV0bV9jYW1wYWlnbj0ke3dpZGdldElkfSZ1dG1fY29udGVudD0ke2NhbXBhaWduVGl0bGV9XCIgc3R5bGU9XCJkaXNwbGF5OiBibG9ja1wiPlxyXG4gICAgICA8aW1nIHNyYz1cIiR7cmVzcG9uc2UuaW1hZ2VfdXJsfVwiIFxyXG4gICAgICBpZD1cIiR7d2lkZ2V0SWR9XCJcclxuICAgICAgd2lkdGg9XCIke3Jlc3BvbnNlLndpZHRofVwiIFxyXG4gICAgICBoZWlnaHQ9XCIke3Jlc3BvbnNlLmhlaWdodH1cIiBcclxuICAgICAgYWx0PVwiJHtyZXNwb25zZS50aXRsZX1cIiAvPlxyXG4gICAgICA8L2E+YFxyXG4gICAgICAgIC8vIFNldCBhZGRpdGlvbmFsIGluZm9ybWF0aW9uXHJcbiAgICAgICAgdG9uaWNEaXYuc2V0QXR0cmlidXRlKCdkYXRhLXdpZHRoJywgcmVzcG9uc2Uud2lkdGgpXHJcbiAgICAgICAgdG9uaWNEaXYuc2V0QXR0cmlidXRlKCdkYXRhLWhlaWdodCcsIHJlc3BvbnNlLmhlaWdodClcclxuXHJcbiAgICAgICAgLy8gQWRkIHRvIHdpZGdldHMgbWFwXHJcbiAgICAgICAgdGhpcy53aWRnZXRzLnNldCh3aWRnZXRJZCwgcmVzcG9uc2UgYXMgdHlwZW9mIFdpZGdldClcclxuICAgICAgICAvLyBBbm5veWluZyB0aGF0IHRoaXMgaXMgbmVlZGVkIGJ1dCBJIGNhbid0IGVmZmVjdGl2ZWx5IG9ic2VydmUgdGhlIG1hcFxyXG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMgJiYgdGhpcy5vcHRpb25zLndpZGdldHNDaGFuZ2VkQ2FsbGJhY2spIHtcclxuICAgICAgICAgIHJlc3BvbnNlLmlkID0gd2lkZ2V0SWRcclxuICAgICAgICAgIHRoaXMub3B0aW9ucy53aWRnZXRzQ2hhbmdlZENhbGxiYWNrKHJlc3BvbnNlIGFzIHR5cGVvZiBXaWRnZXQpXHJcbiAgICAgICAgfVxyXG4gICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgdGhyb3cgZVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBMb2FkIHRoZSBUb25pY1BvdyBzY3JpcHQocykgYW5kIGRlZmF1bHQgc2V0dGluZ3NcclxuICBsb2FkID0gYXN5bmMgKCkgPT4ge1xyXG4gICAgLy8gV2Ugb25seSB3b3JrIGluIGEgYnJvd3NlclxyXG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1RvbmljUG93IGVtYmVkIG9ubHkgd29ya3MgaW4gdGhlIGJyb3dzZXInKVxyXG4gICAgICByZXR1cm5cclxuICAgIH1cclxuXHJcbiAgICAvLyBMb2FkIGFsbCB0b25pY3MgZm91bmQgb24gdGhlIHBhZ2UgKGlmIHdlIGhhdmUgZGl2KVxyXG4gICAgY29uc3QgdG9uaWNEaXZzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSh0aGlzLmNvbmZpZy53aWRnZXREaXZDbGFzcylcclxuICAgIGlmICh0b25pY0RpdnMgJiYgdG9uaWNEaXZzLmxlbmd0aCA+IDApIHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBhd2FpdCB0aGlzLmxvYWREaXZzKClcclxuICAgICAgICBjb25zb2xlLmxvZygnJWMgVG9uaWNQb3cgd2lkZ2V0KHMpIGxvYWRlZCEgJywgJ2JhY2tncm91bmQ6ICM5NzRDRDI7IGNvbG9yOiAjZmZmJylcclxuICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgIHRocm93IGVcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIFByb2Nlc3MgdmlzaXRvciB0b2tlblxyXG4gICAgY29uc3Qgc2Vzc2lvbiA9IHRoaXMuY2FwdHVyZVZpc2l0b3JTZXNzaW9uKClcclxuXHJcbiAgICAvLyBDYXB0dXJlIGV2ZW50cyBpZiB3ZSBoYXZlIGEgc2Vzc2lvblxyXG4gICAgaWYgKHNlc3Npb24pIHtcclxuICAgICAgdGhpcy5ldmVudHMgPSBuZXcgRXZlbnRzKHNlc3Npb24pXHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbnZhciB0cG93ID0gbmV3IFRvbmljUG93KClcclxuXHJcbjsod2luZG93IGFzIGFueSkuVG9uaWNQb3cgPSB0cG93IHx8IHt9XHJcbi8vIEF1dG8tbG9hZCBhbmQgc2V0IG9uIHdpbmRvd1xyXG4iLCIvKiBnbG9iYWwgbG9jYWxTdG9yYWdlICovXHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTdG9yYWdlIHtcclxuICAvKlxyXG4gIHJlbW92ZVN0b3JhZ2U6IHJlbW92ZXMgYSBrZXkgZnJvbSBsb2NhbFN0b3JhZ2UgYW5kIGl0cyBzaWJsaW5nIGV4cGlyYWN5IGtleVxyXG4gIHBhcmFtczpcclxuICAgICAga2V5IDxzdHJpbmc+IDogbG9jYWxTdG9yYWdlIGtleSB0byByZW1vdmVcclxuICByZXR1cm5zOlxyXG4gICAgICA8Ym9vbGVhbj4gOiB0ZWxsaW5nIGlmIG9wZXJhdGlvbiBzdWNjZWVkZWRcclxuICAqL1xyXG4gIHJlbW92ZVN0b3JhZ2UgPSAobmFtZTogc3RyaW5nKSA9PiB7XHJcbiAgICB0cnkge1xyXG4gICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShuYW1lKVxyXG4gICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShgJHtuYW1lfV9leHBpcmVzSW5gKVxyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICBjb25zb2xlLmxvZyhcclxuICAgICAgICBgcmVtb3ZlU3RvcmFnZTogRXJyb3IgcmVtb3Zpbmcga2V5IFske25hbWV9XSBmcm9tIGxvY2FsU3RvcmFnZTogJHtKU09OLnN0cmluZ2lmeShlKX1gXHJcbiAgICAgIClcclxuICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICB9XHJcbiAgICByZXR1cm4gdHJ1ZVxyXG4gIH1cclxuXHJcbiAgLypcclxuICBnZXRTdG9yYWdlOiByZXRyaWV2ZXMgYSBrZXkgZnJvbSBsb2NhbFN0b3JhZ2UgcHJldmlvdXNseSBzZXQgd2l0aCBzZXRTdG9yYWdlKCkuXHJcbiAgcGFyYW1zOlxyXG4gICAgICBrZXkgPHN0cmluZz4gOiBsb2NhbFN0b3JhZ2Uga2V5XHJcbiAgcmV0dXJuczpcclxuICAgICAgPHN0cmluZz4gOiB2YWx1ZSBvZiBsb2NhbFN0b3JhZ2Uga2V5XHJcbiAgICAgIG51bGwgOiBpbiBjYXNlIG9mIGV4cGlyZWQga2V5IG9yIGZhaWx1cmVcclxuICAqL1xyXG4gIGdldFN0b3JhZ2UgPSAoa2V5OiBzdHJpbmcpID0+IHtcclxuICAgIC8vIGVwb2NoIHRpbWUsIGxldHMgZGVhbCBvbmx5IHdpdGggaW50ZWdlclxyXG4gICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKVxyXG5cclxuICAgIC8vIFNldCBleHBpcmF0aW9uIGZvciBzdG9yYWdlXHJcbiAgICBsZXQgZXhwaXJlc1xyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgIGV4cGlyZXMgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShgJHtrZXl9X2V4cGlyZXNgKVxyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICBjb25zb2xlLmxvZyhgZ2V0SXRlbTogZXJyb3IgZ2V0dGluZyBsb2NhbFN0b3JhZ2U6ICR7SlNPTi5zdHJpbmdpZnkoZSl9YClcclxuICAgICAgcmV0dXJuIG51bGxcclxuICAgIH1cclxuXHJcbiAgICBpZiAoZXhwaXJlcyA9PT0gdW5kZWZpbmVkIHx8IGV4cGlyZXMgPT09IG51bGwpIHtcclxuICAgICAgZXhwaXJlcyA9IDBcclxuICAgIH1cclxuXHJcbiAgICAvLyBFeHBpcmVkXHJcbiAgICBpZiAoZXhwaXJlcyA8IG5vdykge1xyXG4gICAgICB0aGlzLnJlbW92ZVN0b3JhZ2Uoa2V5KVxyXG4gICAgICByZXR1cm4gbnVsbFxyXG4gICAgfVxyXG5cclxuICAgIC8vIEdldCB0aGUgZXhpc3RpbmcgaXRlbVxyXG4gICAgdHJ5IHtcclxuICAgICAgcmV0dXJuIGxvY2FsU3RvcmFnZS5nZXRJdGVtKGtleSlcclxuICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgY29uc29sZS5sb2coYGdldFN0b3JhZ2U6IEVycm9yIHJlYWRpbmcga2V5IFske2tleX1dIGZyb20gbG9jYWxTdG9yYWdlOiAke0pTT04uc3RyaW5naWZ5KGUpfWApXHJcbiAgICAgIHJldHVybiBudWxsXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKlxyXG4gIHNldFN0b3JhZ2U6IHdyaXRlcyBhIGtleSBpbnRvIGxvY2FsU3RvcmFnZSBzZXR0aW5nIGEgZXhwaXJlIHRpbWVcclxuICBwYXJhbXM6XHJcbiAgICAgIGtleSA8c3RyaW5nPiAgICAgOiBsb2NhbFN0b3JhZ2Uga2V5XHJcbiAgICAgIHZhbHVlIDxzdHJpbmc+ICAgOiBsb2NhbFN0b3JhZ2UgdmFsdWVcclxuICAgICAgZXhwaXJlcyA8bnVtYmVyPiA6IG51bWJlciBvZiBzZWNvbmRzIGZyb20gbm93IHRvIGV4cGlyZSB0aGUga2V5XHJcbiAgcmV0dXJuczpcclxuICAgICAgPGJvb2xlYW4+IDogdGVsbGluZyBpZiBvcGVyYXRpb24gc3VjY2VlZGVkXHJcbiAgKi9cclxuICBzZXRTdG9yYWdlID0gKGtleTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nLCBleHBpcmVzOiBudW1iZXIgfCBudWxsID0gbnVsbCkgPT4ge1xyXG4gICAgLy8gRXhwaXJlZCB0aW1lXHJcbiAgICBpZiAoZXhwaXJlcykge1xyXG4gICAgICBleHBpcmVzID0gTWF0aC5hYnMoZXhwaXJlcykgLy8gbWFrZSBzdXJlIGl0J3MgcG9zaXRpdmVcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGV4cGlyZXMgPSAyNCAqIDYwICogNjAgLy8gZGVmYXVsdDogc2Vjb25kcyBmb3IgMSBkYXlcclxuICAgIH1cclxuXHJcbiAgICAvLyBNaWxsaSBzZWNvbmRzIHNpbmNlIGVwb2NoIHRpbWUsIGxldHMgZGVhbCBvbmx5IHdpdGggaW50ZWdlclxyXG4gICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKVxyXG4gICAgY29uc3Qgc2NoZWR1bGUgPSBub3cgKyBleHBpcmVzICogMTAwMFxyXG4gICAgdHJ5IHtcclxuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oa2V5LCB2YWx1ZSlcclxuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oYCR7a2V5fV9leHBpcmVzYCwgc2NoZWR1bGUudG9TdHJpbmcoKSlcclxuICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgY29uc29sZS5sb2coYHNldFN0b3JhZ2U6IEVycm9yIHNldHRpbmcga2V5IFske2tleX1dIGluIGxvY2FsU3RvcmFnZTogJHtKU09OLnN0cmluZ2lmeShlKX1gKVxyXG4gICAgICByZXR1cm4gZmFsc2VcclxuICAgIH1cclxuICAgIHJldHVybiB0cnVlXHJcbiAgfVxyXG59XHJcbiIsIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdGlmKF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0pIHtcblx0XHRyZXR1cm4gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuIiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5nID0gKGZ1bmN0aW9uKCkge1xuXHRpZiAodHlwZW9mIGdsb2JhbFRoaXMgPT09ICdvYmplY3QnKSByZXR1cm4gZ2xvYmFsVGhpcztcblx0dHJ5IHtcblx0XHRyZXR1cm4gdGhpcyB8fCBuZXcgRnVuY3Rpb24oJ3JldHVybiB0aGlzJykoKTtcblx0fSBjYXRjaCAoZSkge1xuXHRcdGlmICh0eXBlb2Ygd2luZG93ID09PSAnb2JqZWN0JykgcmV0dXJuIHdpbmRvdztcblx0fVxufSkoKTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSAob2JqLCBwcm9wKSA9PiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCkpIiwiLy8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5yID0gKGV4cG9ydHMpID0+IHtcblx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG5cdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG5cdH1cblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbn07IiwidmFyIHNjcmlwdFVybDtcbmlmIChfX3dlYnBhY2tfcmVxdWlyZV9fLmcuaW1wb3J0U2NyaXB0cykgc2NyaXB0VXJsID0gX193ZWJwYWNrX3JlcXVpcmVfXy5nLmxvY2F0aW9uICsgXCJcIjtcbnZhciBkb2N1bWVudCA9IF9fd2VicGFja19yZXF1aXJlX18uZy5kb2N1bWVudDtcbmlmICghc2NyaXB0VXJsICYmIGRvY3VtZW50KSB7XG5cdGlmIChkb2N1bWVudC5jdXJyZW50U2NyaXB0KVxuXHRcdHNjcmlwdFVybCA9IGRvY3VtZW50LmN1cnJlbnRTY3JpcHQuc3JjXG5cdGlmICghc2NyaXB0VXJsKSB7XG5cdFx0dmFyIHNjcmlwdHMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcInNjcmlwdFwiKTtcblx0XHRpZihzY3JpcHRzLmxlbmd0aCkgc2NyaXB0VXJsID0gc2NyaXB0c1tzY3JpcHRzLmxlbmd0aCAtIDFdLnNyY1xuXHR9XG59XG4vLyBXaGVuIHN1cHBvcnRpbmcgYnJvd3NlcnMgd2hlcmUgYW4gYXV0b21hdGljIHB1YmxpY1BhdGggaXMgbm90IHN1cHBvcnRlZCB5b3UgbXVzdCBzcGVjaWZ5IGFuIG91dHB1dC5wdWJsaWNQYXRoIG1hbnVhbGx5IHZpYSBjb25maWd1cmF0aW9uXG4vLyBvciBwYXNzIGFuIGVtcHR5IHN0cmluZyAoXCJcIikgYW5kIHNldCB0aGUgX193ZWJwYWNrX3B1YmxpY19wYXRoX18gdmFyaWFibGUgZnJvbSB5b3VyIGNvZGUgdG8gdXNlIHlvdXIgb3duIGxvZ2ljLlxuaWYgKCFzY3JpcHRVcmwpIHRocm93IG5ldyBFcnJvcihcIkF1dG9tYXRpYyBwdWJsaWNQYXRoIGlzIG5vdCBzdXBwb3J0ZWQgaW4gdGhpcyBicm93c2VyXCIpO1xuc2NyaXB0VXJsID0gc2NyaXB0VXJsLnJlcGxhY2UoLyMuKiQvLCBcIlwiKS5yZXBsYWNlKC9cXD8uKiQvLCBcIlwiKS5yZXBsYWNlKC9cXC9bXlxcL10rJC8sIFwiL1wiKTtcbl9fd2VicGFja19yZXF1aXJlX18ucCA9IHNjcmlwdFVybDsiLCIvLyBzdGFydHVwXG4vLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbi8vIFRoaXMgZW50cnkgbW9kdWxlIGlzIHJlZmVyZW5jZWQgYnkgb3RoZXIgbW9kdWxlcyBzbyBpdCBjYW4ndCBiZSBpbmxpbmVkXG52YXIgX193ZWJwYWNrX2V4cG9ydHNfXyA9IF9fd2VicGFja19yZXF1aXJlX18oNjA3KTtcbiJdLCJzb3VyY2VSb290IjoiIn0=