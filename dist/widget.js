(()=>{var t={916:(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});const n=i.p+"0cc67b926321b46c35cc929178804e2f.svg"},913:(t,e,i)=>{var n;void 0===(n=function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(){this.isEnvironmentValid=t=>this.environments.includes(t),this.setEnvironment=t=>{t&&this.isEnvironmentValid(t)&&(this.environment=t,t===this.environmentStaging?(this.apiUrl=this.apiUrlStaging,this.eventsUrl=this.eventsUrlStaging):t===this.environmentLocal?(this.apiUrl=this.apiUrlLocal,this.eventsUrl=this.eventsUrlLocal):t===this.environmentProduction&&(this.apiUrl=this.apiUrlProduction,this.eventsUrl=this.eventsUrlProduction))},this.environmentLocal="local",this.environmentStaging="staging",this.environmentProduction="production",this.apiUrl="https://api.tonicpow.com",this.apiUrlLocal="http://localhost:3000",this.apiUrlStaging="https://api.staging.tonicpow.com",this.apiUrlProduction="https://api.tonicpow.com",this.eventsUrl="https://events.tonicpow.com",this.eventsUrlLocal="http://localhost:3002",this.eventsUrlStaging="https://events.staging.tonicpow.com",this.eventsUrlProduction="https://events.tonicpow.com",this.customEnvironment="data-environment",this.environment="",this.environments=[this.environmentLocal,this.environmentStaging,this.environmentProduction],this.maxSessionDays=60,this.sessionName="tncpw_session",this.version="v0.0.8",this.widgetDivClass="tonicpow-widget",this.widgetId="data-widget-id"}}}.apply(e,[i,e]))||(t.exports=n)},242:function(t,e,i){var n,o,s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};n=[i,e,i(913)],void 0===(o=function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i=s(i),e.default=class{constructor(t){this.detectWidgetClick=()=>{document.addEventListener("click",(async t=>{let e=(t||window.event).target?.parentElement?.parentElement;if(e?.classList?.contains("tonicpow-widget"))try{await this.sendEvent("click",e.getAttribute("widget-id")||"")}catch(t){console.error("failed to report interaction: click",t)}}))},this.detectBounce=()=>{window.onbeforeunload=()=>{this.sendEvent("bounce",((new Date).getTime()-this.start).toString())}},this.detectInteraction=()=>{document.addEventListener("mousedown",(async()=>{if(!this.interactionSent)try{await this.sendEvent("interaction","mousedown"),this.interactionSent=!0}catch(t){console.error("failed to report interaction: mousedown",t)}})),document.addEventListener("scroll",(async()=>{if(!this.interactionSent)try{await this.sendEvent("interaction","scroll"),this.interactionSent=!0}catch(t){console.error("failed to report interaction: scroll",t)}})),document.addEventListener("keypress",(async()=>{if(!this.interactionSent)try{await this.sendEvent("interaction","keypress"),this.interactionSent=!0}catch(t){console.error("failed to report interaction: keypress",t)}}))},this.sendEvent=async(t,e)=>{if(!this.sessionId)return void console.info("you must call init with a session before sending events");let n=new i.default,o={v:n.version,name:t,tncpw_session:this.sessionId,data:e};await fetch(`${n.eventsUrl}/v1/events?d=${btoa(JSON.stringify(o))}`,{method:"get"})},this.sessionId=t,this.interactionSent=!1,this.start=(new Date).getTime(),this.detectInteraction(),this.detectBounce(),this.detectWidgetClick()}}}.apply(e,n))||(t.exports=o)},607:function(t,e,i){var n,o,s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};n=[i,e,i(916),i(913),i(242),i(912)],void 0===(o=function(t,e,i,n,o,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i=s(i),n=s(n),o=s(o),r=s(r);class a{constructor(t){this.registerEvents=()=>{if(!this.events){let t=this.getVisitorSession();t&&t.length&&(this.events=new o.default(t))}},this.setOreo=(t,e,i)=>{const n=new Date;n.setTime(n.getTime()+864e5*i),document.cookie=`${t}=${e};path=/;expires=${n.toUTCString()}`},this.captureVisitorSession=(t="")=>{let e=t;return t&&t.length||"undefined"==typeof window||(e=new URLSearchParams(window.location.search).get(this.config.sessionName)||""),e&&e.length>0?(this.setOreo(this.config.sessionName,e,this.config.maxSessionDays),this.storage.setStorage(this.config.sessionName,e,86400*this.config.maxSessionDays),e):null},this.getVisitorSession=()=>this.storage.getStorage(this.config.sessionName),this.loadDivs=async()=>{const t=document.getElementsByClassName(this.config.widgetDivClass);for(let n=t.length-1;n>=0;n--){const o=t[n];if(!o)continue;const s=o.getAttribute(this.config.widgetId);if(!s){console.log(`${s} not found`);continue}const r=o.getAttribute(this.config.customEnvironment);this.config.setEnvironment(r||"production"),this.widgets.set(s,null);try{const t=await fetch(`${this.config.apiUrl}/v1/widgets/display/${s}?provider=embed-${this.config.version}`);var e;403===t.status?(console.info(`${t.status}: Domain not allowed`),e={link_url:"https://tonicpow.com",image_url:i.default}):e=await t.json();const n=encodeURIComponent(e.title);o.innerHTML=`\n      <a href="${e.link_url}?utm_source=tonicpow-widgets&utm_medium=widget&utm_campaign=${s}&utm_content=${n}" style="display: block">\n      <img src="${e.image_url}" \n      id="${s}"\n      width="${e.width}" \n      height="${e.height}" \n      alt="${e.title}" />\n      </a>`,o.setAttribute("data-width",e.width),o.setAttribute("data-height",e.height),this.widgets.set(s,e),this.options&&this.options.widgetsChangedCallback&&this.options.widgetsChangedCallback(s,e)}catch(t){throw t}}},this.load=async()=>{if("undefined"==typeof window)return void console.error("TonicPow embed only works in the browser");const t=document.getElementsByClassName(this.config.widgetDivClass);if(t&&t.length>0)try{await this.loadDivs(),console.log("%c TonicPow widget(s) loaded! ","background: #974CD2; color: #fff")}catch(t){throw t}const e=this.captureVisitorSession();e&&(this.events=new o.default(e))},this.config=new n.default,this.storage=new r.default,this.widgets=new Map,this.options=t,"complete"===document.readyState||"interactive"===document.readyState?(this.load(),this.registerEvents()):document.addEventListener("DOMContentLoaded",(()=>{this.load(),this.registerEvents()}))}}var c;e.default=a;try{c=new a}catch(t){console.log("errrmagord",t)}window.TonicPow=c||{}}.apply(e,n))||(t.exports=o)},912:(t,e,i)=>{var n;void 0===(n=function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(){this.removeStorage=t=>{try{localStorage.removeItem(t),localStorage.removeItem(`${t}_expiresIn`)}catch(e){return console.log(`removeStorage: Error removing key [${t}] from localStorage: ${JSON.stringify(e)}`),!1}return!0},this.getStorage=t=>{const e=Date.now();let i;try{i=localStorage.getItem(`${t}_expires`)}catch(t){return console.log(`getItem: error getting localStorage: ${JSON.stringify(t)}`),null}if(null==i&&(i=0),i<e)return this.removeStorage(t),null;try{return localStorage.getItem(t)}catch(e){return console.log(`getStorage: Error reading key [${t}] from localStorage: ${JSON.stringify(e)}`),null}},this.setStorage=(t,e,i=null)=>{i=i?Math.abs(i):86400;const n=Date.now()+1e3*i;try{localStorage.setItem(t,e),localStorage.setItem(`${t}_expires`,n.toString())}catch(e){return console.log(`setStorage: Error setting key [${t}] in localStorage: ${JSON.stringify(e)}`),!1}return!0}}}}.apply(e,[i,e]))||(t.exports=n)}},e={};function i(n){if(e[n])return e[n].exports;var o=e[n]={exports:{}};return t[n].call(o.exports,o,o.exports,i),o.exports}i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t;i.g.importScripts&&(t=i.g.location+"");var e=i.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var n=e.getElementsByTagName("script");n.length&&(t=n[n.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=t})(),i(607)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9AdG9uaWNwb3cvd2lkZ2V0Ly4vc3JjL2Fzc2V0cy9pbWFnZV9wbGFjZWhvbGRlcl90b25pY3Bvd19zcXVhcmUuc3ZnIiwid2VicGFjazovL0B0b25pY3Bvdy93aWRnZXQvLi9zcmMvY29uZmlnLnRzIiwid2VicGFjazovL0B0b25pY3Bvdy93aWRnZXQvLi9zcmMvZXZlbnRzLnRzIiwid2VicGFjazovL0B0b25pY3Bvdy93aWRnZXQvLi9zcmMvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vQHRvbmljcG93L3dpZGdldC8uL3NyYy9zdG9yYWdlLnRzIiwid2VicGFjazovL0B0b25pY3Bvdy93aWRnZXQvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vQHRvbmljcG93L3dpZGdldC93ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMiLCJ3ZWJwYWNrOi8vQHRvbmljcG93L3dpZGdldC93ZWJwYWNrL3J1bnRpbWUvZ2xvYmFsIiwid2VicGFjazovL0B0b25pY3Bvdy93aWRnZXQvd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly9AdG9uaWNwb3cvd2lkZ2V0L3dlYnBhY2svcnVudGltZS9tYWtlIG5hbWVzcGFjZSBvYmplY3QiLCJ3ZWJwYWNrOi8vQHRvbmljcG93L3dpZGdldC93ZWJwYWNrL3J1bnRpbWUvcHVibGljUGF0aCIsIndlYnBhY2s6Ly9AdG9uaWNwb3cvd2lkZ2V0L3dlYnBhY2svc3RhcnR1cCJdLCJuYW1lcyI6WyJpc0Vudmlyb25tZW50VmFsaWQiLCJlbnZpcm9ubWVudCIsInRoaXMiLCJlbnZpcm9ubWVudHMiLCJpbmNsdWRlcyIsInNldEVudmlyb25tZW50IiwiZW52aXJvbm1lbnRTdGFnaW5nIiwiYXBpVXJsIiwiYXBpVXJsU3RhZ2luZyIsImV2ZW50c1VybCIsImV2ZW50c1VybFN0YWdpbmciLCJlbnZpcm9ubWVudExvY2FsIiwiYXBpVXJsTG9jYWwiLCJldmVudHNVcmxMb2NhbCIsImVudmlyb25tZW50UHJvZHVjdGlvbiIsImFwaVVybFByb2R1Y3Rpb24iLCJldmVudHNVcmxQcm9kdWN0aW9uIiwiY3VzdG9tRW52aXJvbm1lbnQiLCJtYXhTZXNzaW9uRGF5cyIsInNlc3Npb25OYW1lIiwidmVyc2lvbiIsIndpZGdldERpdkNsYXNzIiwid2lkZ2V0SWQiLCJzZXNzaW9uSWQiLCJkZXRlY3RXaWRnZXRDbGljayIsImRvY3VtZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsImFzeW5jIiwiZSIsImNvbnRhaW5lciIsIndpbmRvdyIsImV2ZW50IiwidGFyZ2V0IiwicGFyZW50RWxlbWVudCIsImNsYXNzTGlzdCIsImNvbnRhaW5zIiwic2VuZEV2ZW50IiwiZ2V0QXR0cmlidXRlIiwiY29uc29sZSIsImVycm9yIiwiZGV0ZWN0Qm91bmNlIiwib25iZWZvcmV1bmxvYWQiLCJEYXRlIiwiZ2V0VGltZSIsInN0YXJ0IiwidG9TdHJpbmciLCJkZXRlY3RJbnRlcmFjdGlvbiIsImludGVyYWN0aW9uU2VudCIsImV2ZW50TmFtZSIsImRhdGEiLCJpbmZvIiwiY29uZmlnIiwicGF5bG9hZCIsInYiLCJuYW1lIiwidG5jcHdfc2Vzc2lvbiIsImZldGNoIiwiYnRvYSIsIkpTT04iLCJzdHJpbmdpZnkiLCJtZXRob2QiLCJUb25pY1BvdyIsIm9wdGlvbnMiLCJyZWdpc3RlckV2ZW50cyIsImV2ZW50cyIsInNlc3Npb24iLCJnZXRWaXNpdG9yU2Vzc2lvbiIsImxlbmd0aCIsInNldE9yZW8iLCJ2YWx1ZSIsImRheXMiLCJkYXRlIiwic2V0VGltZSIsImNvb2tpZSIsInRvVVRDU3RyaW5nIiwiY2FwdHVyZVZpc2l0b3JTZXNzaW9uIiwiY3VzdG9tU2Vzc2lvbklkIiwiVVJMU2VhcmNoUGFyYW1zIiwibG9jYXRpb24iLCJzZWFyY2giLCJnZXQiLCJzdG9yYWdlIiwic2V0U3RvcmFnZSIsImdldFN0b3JhZ2UiLCJsb2FkRGl2cyIsInRvbmljRGl2cyIsImdldEVsZW1lbnRzQnlDbGFzc05hbWUiLCJpIiwidG9uaWNEaXYiLCJsb2ciLCJ3aWRnZXRzIiwic2V0IiwicHJvbWlzZSIsInJlc3BvbnNlIiwic3RhdHVzIiwibGlua191cmwiLCJpbWFnZV91cmwiLCJqc29uIiwiY2FtcGFpZ25UaXRsZSIsImVuY29kZVVSSUNvbXBvbmVudCIsInRpdGxlIiwiaW5uZXJIVE1MIiwid2lkdGgiLCJoZWlnaHQiLCJzZXRBdHRyaWJ1dGUiLCJ3aWRnZXRzQ2hhbmdlZENhbGxiYWNrIiwibG9hZCIsIk1hcCIsInJlYWR5U3RhdGUiLCJ0cG93IiwicmVtb3ZlU3RvcmFnZSIsImxvY2FsU3RvcmFnZSIsInJlbW92ZUl0ZW0iLCJrZXkiLCJub3ciLCJleHBpcmVzIiwiZ2V0SXRlbSIsIk1hdGgiLCJhYnMiLCJzY2hlZHVsZSIsInNldEl0ZW0iLCJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiX193ZWJwYWNrX21vZHVsZXNfXyIsImNhbGwiLCJkIiwiZGVmaW5pdGlvbiIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnIiwiZ2xvYmFsVGhpcyIsIkZ1bmN0aW9uIiwib2JqIiwicHJvcCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwic2NyaXB0VXJsIiwiaW1wb3J0U2NyaXB0cyIsImN1cnJlbnRTY3JpcHQiLCJzcmMiLCJzY3JpcHRzIiwiZ2V0RWxlbWVudHNCeVRhZ05hbWUiLCJFcnJvciIsInJlcGxhY2UiLCJwIl0sIm1hcHBpbmdzIjoic0VBQUEsUUFBZSxJQUEwQix3Qyw0R0NBekMsZ0JBcUJFLGNBd0JBLEtBQUFBLG1CQUFzQkMsR0FBd0JDLEtBQUtDLGFBQWFDLFNBQVNILEdBR3pFLEtBQUFJLGVBQWtCSixJQUVYQSxHQUtBQyxLQUFLRixtQkFBbUJDLEtBSzdCQyxLQUFLRCxZQUFjQSxFQUdmQSxJQUFnQkMsS0FB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ZUFBZVIsRUFBUyxhQUFjLENBQUV2RCxPQUFPLEssTUNMdkQsSUFBSTJFLEVBQ0F0QixFQUFvQlksRUFBRVcsZ0JBQWVELEVBQVl0QixFQUFvQlksRUFBRXhELFNBQVcsSUFDdEYsSUFBSXJELEVBQVdpRyxFQUFvQlksRUFBRTdHLFNBQ3JDLElBQUt1SCxHQUFhdkgsSUFDYkEsRUFBU3lILGdCQUNaRixFQUFZdkgsRUFBU3lILGNBQWNDLE1BQy9CSCxHQUFXLENBQ2YsSUFBSUksRUFBVTNILEVBQVM0SCxxQkFBcUIsVUFDekNELEVBQVFqRixTQUFRNkUsRUFBWUksRUFBUUEsRUFBUWpGLE9BQVMsR0FBR2dGLEtBSzdELElBQUtILEVBQVcsTUFBTSxJQUFJTSxNQUFNLHlEQUNoQ04sRUFBWUEsRUFBVU8sUUFBUSxPQUFRLElBQUlBLFFBQVEsUUFBUyxJQUFJQSxRQUFRLFlBQWEsS0FDcEY3QixFQUFvQjhCLEVBQUlSLEcsR0NaRXRCLEVBQW9CLE0iLCJmaWxlIjoid2lkZ2V0LmpzIiwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgX193ZWJwYWNrX3B1YmxpY19wYXRoX18gKyBcIjBjYzY3YjkyNjMyMWI0NmMzNWNjOTI5MTc4ODA0ZTJmLnN2Z1wiOyIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIENvbmZpZyB7XHJcbiAgZW52aXJvbm1lbnRMb2NhbDogc3RyaW5nXHJcbiAgZW52aXJvbm1lbnRTdGFnaW5nOiBzdHJpbmdcclxuICBlbnZpcm9ubWVudFByb2R1Y3Rpb246IHN0cmluZ1xyXG4gIGFwaVVybDogc3RyaW5nXHJcbiAgYXBpVXJsTG9jYWw6IHN0cmluZ1xyXG4gIGFwaVVybFN0YWdpbmc6IHN0cmluZ1xyXG4gIGFwaVVybFByb2R1Y3Rpb246IHN0cmluZ1xyXG4gIGV2ZW50c1VybDogc3RyaW5nXHJcbiAgZXZlbnRzVXJsTG9jYWw6IHN0cmluZ1xyXG4gIGV2ZW50c1VybFN0YWdpbmc6IHN0cmluZ1xyXG4gIGV2ZW50c1VybFByb2R1Y3Rpb246IHN0cmluZ1xyXG4gIGN1c3RvbUVudmlyb25tZW50OiBzdHJpbmdcclxuICBlbnZpcm9ubWVudDogc3RyaW5nXHJcbiAgZW52aXJvbm1lbnRzOiBzdHJpbmdbXVxyXG4gIG1heFNlc3Npb25EYXlzOiBudW1iZXJcclxuICBzZXNzaW9uTmFtZTogc3RyaW5nXHJcbiAgdmVyc2lvbjogc3RyaW5nXHJcbiAgd2lkZ2V0RGl2Q2xhc3M6IHN0cmluZ1xyXG4gIHdpZGdldElkOiBzdHJpbmdcclxuXHJcbiAgY29uc3RydWN0b3IoKSB7XHJcbiAgICB0aGlzLmVudmlyb25tZW50TG9jYWwgPSAnbG9jYWwnXHJcbiAgICB0aGlzLmVudmlyb25tZW50U3RhZ2luZyA9ICdzdGFnaW5nJ1xyXG4gICAgdGhpcy5lbnZpcm9ubWVudFByb2R1Y3Rpb24gPSAncHJvZHVjdGlvbidcclxuXHJcbiAgICB0aGlzLmFwaVVybCA9ICdodHRwczovL2FwaS50b25pY3Bvdy5jb20nXHJcbiAgICB0aGlzLmFwaVVybExvY2FsID0gJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMCdcclxuICAgIHRoaXMuYXBpVXJsU3RhZ2luZyA9ICdodHRwczovL2FwaS5zdGFnaW5nLnRvbmljcG93LmNvbSdcclxuICAgIHRoaXMuYXBpVXJsUHJvZHVjdGlvbiA9ICdodHRwczovL2FwaS50b25pY3Bvdy5jb20nXHJcbiAgICB0aGlzLmV2ZW50c1VybCA9ICdodHRwczovL2V2ZW50cy50b25pY3Bvdy5jb20nXHJcbiAgICB0aGlzLmV2ZW50c1VybExvY2FsID0gJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMidcclxuICAgIHRoaXMuZXZlbnRzVXJsU3RhZ2luZyA9ICdodHRwczovL2V2ZW50cy5zdGFnaW5nLnRvbmljcG93LmNvbSdcclxuICAgIHRoaXMuZXZlbnRzVXJsUHJvZHVjdGlvbiA9ICdodHRwczovL2V2ZW50cy50b25pY3Bvdy5jb20nXHJcbiAgICB0aGlzLmN1c3RvbUVudmlyb25tZW50ID0gJ2RhdGEtZW52aXJvbm1lbnQnXHJcbiAgICB0aGlzLmVudmlyb25tZW50ID0gJydcclxuICAgIHRoaXMuZW52aXJvbm1lbnRzID0gW3RoaXMuZW52aXJvbm1lbnRMb2NhbCwgdGhpcy5lbnZpcm9ubWVudFN0YWdpbmcsIHRoaXMuZW52aXJvbm1lbnRQcm9kdWN0aW9uXVxyXG4gICAgdGhpcy5tYXhTZXNzaW9uRGF5cyA9IDYwXHJcbiAgICB0aGlzLnNlc3Npb25OYW1lID0gJ3RuY3B3X3Nlc3Npb24nXHJcbiAgICB0aGlzLnZlcnNpb24gPSAndjAuMC44J1xyXG4gICAgdGhpcy53aWRnZXREaXZDbGFzcyA9ICd0b25pY3Bvdy13aWRnZXQnXHJcbiAgICB0aGlzLndpZGdldElkID0gJ2RhdGEtd2lkZ2V0LWlkJ1xyXG4gIH1cclxuXHJcbiAgLy8gaXNFbnZpcm9ubWVudFZhbGlkIHdpbGwgY2hlY2sgaWYgdGhlIGdpdmVuIGVudmlyb25tZW50IGlzIHZhbGlkXHJcbiAgaXNFbnZpcm9ubWVudFZhbGlkID0gKGVudmlyb25tZW50OiBzdHJpbmcpID0+IHRoaXMuZW52aXJvbm1lbnRzLmluY2x1ZGVzKGVudmlyb25tZW50KVxyXG5cclxuICAvLyBzZXRFbnZpcm9ubWVudCB3aWxsIHNldCB0aGUgZW52aXJvbm1lbnRcclxuICBzZXRFbnZpcm9ubWVudCA9IChlbnZpcm9ubWVudDogc3RyaW5nKSA9PiB7XHJcbiAgICAvLyBObyBlbnZpcm9ubWVudCBzZXQ/IHVzZSB0aGUgZGVmYXVsdFxyXG4gICAgaWYgKCFlbnZpcm9ubWVudCkge1xyXG4gICAgICByZXR1cm5cclxuICAgIH1cclxuXHJcbiAgICAvLyBOb3QgYSB2YWxpZCBlbnZpcm9ubWVudD9cclxuICAgIGlmICghdGhpcy5pc0Vudmlyb25tZW50VmFsaWQoZW52aXJvbm1lbnQpKSB7XHJcbiAgICAgIHJldHVyblxyXG4gICAgfVxyXG5cclxuICAgIC8vIFNldCB0aGUgZW52aXJvbm1lbnRcclxuICAgIHRoaXMuZW52aXJvbm1lbnQgPSBlbnZpcm9ubWVudFxyXG5cclxuICAgIC8vIFNldCB0aGUgQVBJIHVybFxyXG4gICAgaWYgKGVudmlyb25tZW50ID09PSB0aGlzLmVudmlyb25tZW50U3RhZ2luZykge1xyXG4gICAgICB0aGlzLmFwaVVybCA9IHRoaXMuYXBpVXJsU3RhZ2luZ1xyXG4gICAgICB0aGlzLmV2ZW50c1VybCA9IHRoaXMuZXZlbnRzVXJsU3RhZ2luZ1xyXG4gICAgfSBlbHNlIGlmIChlbnZpcm9ubWVudCA9PT0gdGhpcy5lbnZpcm9ubWVudExvY2FsKSB7XHJcbiAgICAgIHRoaXMuYXBpVXJsID0gdGhpcy5hcGlVcmxMb2NhbFxyXG4gICAgICB0aGlzLmV2ZW50c1VybCA9IHRoaXMuZXZlbnRzVXJsTG9jYWxcclxuICAgIH0gZWxzZSBpZiAoZW52aXJvbm1lbnQgPT09IHRoaXMuZW52aXJvbm1lbnRQcm9kdWN0aW9uKSB7XHJcbiAgICAgIHRoaXMuYXBpVXJsID0gdGhpcy5hcGlVcmxQcm9kdWN0aW9uXHJcbiAgICAgIHRoaXMuZXZlbnRzVXJsID0gdGhpcy5ldmVudHNVcmxQcm9kdWN0aW9uXHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBDb25maWcgZnJvbSAnLi9jb25maWcnXHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBFdmVudHMge1xyXG4gIHNlc3Npb25JZDogc3RyaW5nXHJcbiAgc3RhcnQ6IG51bWJlclxyXG4gIGludGVyYWN0aW9uU2VudDogYm9vbGVhblxyXG5cclxuICBjb25zdHJ1Y3RvcihzZXNzaW9uSWQ6IHN0cmluZykge1xyXG4gICAgLy8gU2V0IHRoZSBjdXJyZW50IHNlc3Npb25cclxuICAgIHRoaXMuc2Vzc2lvbklkID0gc2Vzc2lvbklkXHJcblxyXG4gICAgdGhpcy5pbnRlcmFjdGlvblNlbnQgPSBmYWxzZVxyXG5cclxuICAgIC8vIFJlbWVtYmVyIHdoZW4gd2Ugc3RhcnRlZFxyXG4gICAgdGhpcy5zdGFydCA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpXHJcbiAgICB0aGlzLmRldGVjdEludGVyYWN0aW9uKClcclxuICAgIHRoaXMuZGV0ZWN0Qm91bmNlKClcclxuICAgIHRoaXMuZGV0ZWN0V2lkZ2V0Q2xpY2soKVxyXG4gIH1cclxuXHJcbiAgLy8gRGV0ZWN0cyBjbGljayBvbiB0aGUgd2lkZ2V0XHJcbiAgZGV0ZWN0V2lkZ2V0Q2xpY2sgPSAoKSA9PiB7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jIChlOiBFdmVudCkgPT4ge1xyXG4gICAgICAvLyBHZXQgdGhlIGNsaWNrIHRhcmdldFxyXG4gICAgICB2YXIgdGFyZ2V0ID0gKGUgfHwgd2luZG93LmV2ZW50KS50YXJnZXQgYXMgSFRNTERpdkVsZW1lbnRcclxuXHJcbiAgICAgIC8vIEdldCB0aGUgd2lkZ2V0IGNvbnRhaW5lclxyXG4gICAgICBsZXQgY29udGFpbmVyID0gdGFyZ2V0Py5wYXJlbnRFbGVtZW50Py5wYXJlbnRFbGVtZW50XHJcblxyXG4gICAgICAvLyBTZW5kIGV2ZW50IG9ubHkgaWYgd2lkZ2V0IHdhcyBjbGlja2VkXHJcbiAgICAgIGlmIChjb250YWluZXI/LmNsYXNzTGlzdD8uY29udGFpbnMoJ3RvbmljcG93LXdpZGdldCcpKSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgIGF3YWl0IHRoaXMuc2VuZEV2ZW50KCdjbGljaycsIGNvbnRhaW5lci5nZXRBdHRyaWJ1dGUoJ3dpZGdldC1pZCcpIHx8ICcnKVxyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ2ZhaWxlZCB0byByZXBvcnQgaW50ZXJhY3Rpb246IGNsaWNrJywgZSlcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICAvLyBEZXRlY3RzIGEgYm91bmNlIGV2ZW50XHJcbiAgZGV0ZWN0Qm91bmNlID0gKCkgPT4ge1xyXG4gICAgd2luZG93Lm9uYmVmb3JldW5sb2FkID0gKCkgPT4ge1xyXG4gICAgICAvLyBDYWxjdWxhdGUgdGltZSBvbiBwYWdlXHJcbiAgICAgIHRoaXMuc2VuZEV2ZW50KCdib3VuY2UnLCAobmV3IERhdGUoKS5nZXRUaW1lKCkgLSB0aGlzLnN0YXJ0KS50b1N0cmluZygpKVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gRGV0ZWN0cyBhIHBhZ2UgaW50ZXJhY3Rpb25cclxuICBkZXRlY3RJbnRlcmFjdGlvbiA9ICgpID0+IHtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIGFzeW5jICgpID0+IHtcclxuICAgICAgaWYgKCF0aGlzLmludGVyYWN0aW9uU2VudCkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICBhd2FpdCB0aGlzLnNlbmRFdmVudCgnaW50ZXJhY3Rpb24nLCAnbW91c2Vkb3duJylcclxuICAgICAgICAgIHRoaXMuaW50ZXJhY3Rpb25TZW50ID0gdHJ1ZVxyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ2ZhaWxlZCB0byByZXBvcnQgaW50ZXJhY3Rpb246IG1vdXNlZG93bicsIGUpXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9KVxyXG5cclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIGFzeW5jICgpID0+IHtcclxuICAgICAgaWYgKCF0aGlzLmludGVyYWN0aW9uU2VudCkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICBhd2FpdCB0aGlzLnNlbmRFdmVudCgnaW50ZXJhY3Rpb24nLCAnc2Nyb2xsJylcclxuICAgICAgICAgIHRoaXMuaW50ZXJhY3Rpb25TZW50ID0gdHJ1ZVxyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ2ZhaWxlZCB0byByZXBvcnQgaW50ZXJhY3Rpb246IHNjcm9sbCcsIGUpXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9KVxyXG5cclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXByZXNzJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBpZiAoIXRoaXMuaW50ZXJhY3Rpb25TZW50KSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgIGF3YWl0IHRoaXMuc2VuZEV2ZW50KCdpbnRlcmFjdGlvbicsICdrZXlwcmVzcycpXHJcbiAgICAgICAgICB0aGlzLmludGVyYWN0aW9uU2VudCA9IHRydWVcclxuICAgICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCdmYWlsZWQgdG8gcmVwb3J0IGludGVyYWN0aW9uOiBrZXlwcmVzcycsIGUpXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgLy8gU2VuZCBldmVudCB3aWxsIHNlbmQgYW4gZXZlbnQgdG8gVG9uaWNQb3dcclxuICBzZW5kRXZlbnQgPSBhc3luYyAoZXZlbnROYW1lOiBzdHJpbmcsIGRhdGE6IHN0cmluZykgPT4ge1xyXG4gICAgaWYgKCF0aGlzLnNlc3Npb25JZCkge1xyXG4gICAgICBjb25zb2xlLmluZm8oJ3lvdSBtdXN0IGNhbGwgaW5pdCB3aXRoIGEgc2Vzc2lvbiBiZWZvcmUgc2VuZGluZyBldmVudHMnKVxyXG4gICAgICByZXR1cm5cclxuICAgIH1cclxuXHJcbiAgICAvLyBHZXQgY29uZmlnXHJcbiAgICBsZXQgY29uZmlnID0gbmV3IENvbmZpZygpXHJcblxyXG4gICAgLy8gUGFja2FnZSBwYXlsb2FkXHJcbiAgICBsZXQgcGF5bG9hZCA9IHtcclxuICAgICAgdjogY29uZmlnLnZlcnNpb24sXHJcbiAgICAgIG5hbWU6IGV2ZW50TmFtZSxcclxuICAgICAgdG5jcHdfc2Vzc2lvbjogdGhpcy5zZXNzaW9uSWQsXHJcbiAgICAgIGRhdGEsXHJcbiAgICB9XHJcblxyXG4gICAgYXdhaXQgZmV0Y2goYCR7Y29uZmlnLmV2ZW50c1VybH0vdjEvZXZlbnRzP2Q9JHtidG9hKEpTT04uc3RyaW5naWZ5KHBheWxvYWQpKX1gLCB7XHJcbiAgICAgIG1ldGhvZDogJ2dldCcsXHJcbiAgICB9KVxyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgZmFsbGJhY2tJbWFnZSBmcm9tICcuL2Fzc2V0cy9pbWFnZV9wbGFjZWhvbGRlcl90b25pY3Bvd19zcXVhcmUuc3ZnJ1xyXG5pbXBvcnQgQ29uZmlnIGZyb20gJy4vY29uZmlnJ1xyXG5pbXBvcnQgRXZlbnRzIGZyb20gJy4vZXZlbnRzJ1xyXG5pbXBvcnQgU3RvcmFnZSBmcm9tICcuL3N0b3JhZ2UnXHJcbmltcG9ydCBXaWRnZXQgZnJvbSAnLi90eXBlcydcclxuXHJcbmludGVyZmFjZSBUb25pY1Bvd09wdGlvbnMge1xyXG4gIHdpZGdldHNDaGFuZ2VkQ2FsbGJhY2s6ICh3aWRnZXRJZDogc3RyaW5nLCB3aWRnZXQ6IHR5cGVvZiBXaWRnZXQpID0+IHZvaWRcclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVG9uaWNQb3cge1xyXG4gIGNvbmZpZzogQ29uZmlnXHJcbiAgc3RvcmFnZTogU3RvcmFnZVxyXG4gIGV2ZW50czogRXZlbnRzIHwgdW5kZWZpbmVkXHJcbiAgd2lkZ2V0czogTWFwPFN0cmluZywgdHlwZW9mIFdpZGdldCB8IG51bGw+XHJcbiAgb3B0aW9uczogVG9uaWNQb3dPcHRpb25zIHwgdW5kZWZpbmVkXHJcblxyXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnM/OiBUb25pY1Bvd09wdGlvbnMpIHtcclxuICAgIC8vIFNldCBuYW1lc3BhY2VzXHJcbiAgICB0aGlzLmNvbmZpZyA9IG5ldyBDb25maWcoKVxyXG4gICAgdGhpcy5zdG9yYWdlID0gbmV3IFN0b3JhZ2UoKVxyXG4gICAgdGhpcy53aWRnZXRzID0gbmV3IE1hcDxTdHJpbmcsIHR5cGVvZiBXaWRnZXQ+KClcclxuICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnNcclxuXHJcbiAgICAvLyBTdGFydCB0aGUgVG9uaWNQb3cgc2VydmljZSBhbmQgbG9hZCBtb2R1bGVzXHJcblxyXG4gICAgLy8gTG9hZCB0aGUgVG9uaWNQb3cgd2lkZ2V0IHdoZW4gRE9NIGlzIHJlYWR5XHJcbiAgICBpZiAoZG9jdW1lbnQucmVhZHlTdGF0ZSA9PT0gJ2NvbXBsZXRlJyB8fCBkb2N1bWVudC5yZWFkeVN0YXRlID09PSAnaW50ZXJhY3RpdmUnKSB7XHJcbiAgICAgIC8vIFRoaXMgbG9hZHMgaWYgdGhlIDxzY3JpcHQ+IGlzIGR5bmFtaWNhbGx5IGluamVjdGVkIGludG8gdGhlIHBhZ2VcclxuICAgICAgdGhpcy5sb2FkKClcclxuICAgICAgdGhpcy5yZWdpc3RlckV2ZW50cygpXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAvLyBUaGlzIGxvYWRzIGlmIHRoZSA8c2NyaXB0PiBpcyBoYXJkY29kZWQgaW4gdGhlIGh0bWwgcGFnZSBpbiB0aGUgPGhlYWQ+XHJcbiAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5sb2FkKClcclxuICAgICAgICB0aGlzLnJlZ2lzdGVyRXZlbnRzKClcclxuICAgICAgfSlcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIHJlZ2lzdGVyRXZlbnRzIC1SZWdpc3RlcnMgZXZlbnQgbGlzdGVuZXJzLiBSdW5zIG9ubHkgb25jZVxyXG4gIHJlZ2lzdGVyRXZlbnRzID0gKCkgPT4ge1xyXG4gICAgaWYgKCF0aGlzLmV2ZW50cykge1xyXG4gICAgICAvLyBSZWdpc3RlciBldmVudHMgaWYgd2UgaGF2ZSBhIHZhbGlkIHNlc3Npb25cclxuICAgICAgbGV0IHNlc3Npb24gPSB0aGlzLmdldFZpc2l0b3JTZXNzaW9uKClcclxuICAgICAgLy8gVE9ETzogVmFsaWRhdGUgc2Vzc2lvbiBoZXJlXHJcbiAgICAgIGlmIChzZXNzaW9uICYmIHNlc3Npb24ubGVuZ3RoKSB7XHJcbiAgICAgICAgdGhpcy5ldmVudHMgPSBuZXcgRXZlbnRzKHNlc3Npb24pXHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIHNldE9yZW8gZm9yIGNyZWF0aW5nIG5ldyBvcmVvc1xyXG4gIHNldE9yZW8gPSAobmFtZTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nLCBkYXlzOiBudW1iZXIpID0+IHtcclxuICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZSgpXHJcbiAgICBkYXRlLnNldFRpbWUoZGF0ZS5nZXRUaW1lKCkgKyAyNCAqIDYwICogNjAgKiAxMDAwICogZGF5cylcclxuICAgIGRvY3VtZW50LmNvb2tpZSA9IGAke25hbWV9PSR7dmFsdWV9O3BhdGg9LztleHBpcmVzPSR7ZGF0ZS50b1VUQ1N0cmluZygpfWBcclxuICB9XHJcblxyXG4gIC8vIGNhcHR1cmVWaXNpdG9yU2Vzc2lvbiB3aWxsIGNhcHR1cmUgdGhlIHNlc3Npb24gYW5kIHN0b3JlIGl0XHJcbiAgLy8gQnVpbGRzIGEgY29va2llIHNvIGl0J3Mgc2VudCBvbiByZXF1ZXN0cyBhdXRvbWF0aWNhbGx5XHJcbiAgLy8gU3RvcmVzIGluIGxvY2FsIHN0b3JhZ2UgZm9yIGVhc3kgYWNjZXNzIGZyb20gdGhlIGFwcGxpY2F0aW9uXHJcbiAgY2FwdHVyZVZpc2l0b3JTZXNzaW9uID0gKGN1c3RvbVNlc3Npb25JZDogc3RyaW5nID0gJycpID0+IHtcclxuICAgIGxldCBzZXNzaW9uSWQgPSBjdXN0b21TZXNzaW9uSWRcclxuXHJcbiAgICBpZiAoKCFjdXN0b21TZXNzaW9uSWQgfHwgIWN1c3RvbVNlc3Npb25JZC5sZW5ndGgpICYmIHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgIGNvbnN0IHVybFBhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMod2luZG93LmxvY2F0aW9uLnNlYXJjaClcclxuICAgICAgc2Vzc2lvbklkID0gdXJsUGFyYW1zLmdldCh0aGlzLmNvbmZpZy5zZXNzaW9uTmFtZSkgfHwgJydcclxuICAgIH1cclxuICAgIGlmIChzZXNzaW9uSWQgJiYgc2Vzc2lvbklkLmxlbmd0aCA+IDApIHtcclxuICAgICAgdGhpcy5zZXRPcmVvKHRoaXMuY29uZmlnLnNlc3Npb25OYW1lLCBzZXNzaW9uSWQsIHRoaXMuY29uZmlnLm1heFNlc3Npb25EYXlzKVxyXG4gICAgICB0aGlzLnN0b3JhZ2Uuc2V0U3RvcmFnZShcclxuICAgICAgICB0aGlzLmNvbmZpZy5zZXNzaW9uTmFtZSxcclxuICAgICAgICBzZXNzaW9uSWQsXHJcbiAgICAgICAgMjQgKiA2MCAqIDYwICogdGhpcy5jb25maWcubWF4U2Vzc2lvbkRheXNcclxuICAgICAgKVxyXG4gICAgICByZXR1cm4gc2Vzc2lvbklkXHJcbiAgICB9XHJcbiAgICByZXR1cm4gbnVsbFxyXG4gIH1cclxuXHJcbiAgLy8gZ2V0VmlzaXRvclNlc3Npb24gd2lsbCBnZXQgdGhlIHNlc3Npb24gaWYgaXQgZXhpc3RzXHJcbiAgZ2V0VmlzaXRvclNlc3Npb24gPSAoKSA9PiB0aGlzLnN0b3JhZ2UuZ2V0U3RvcmFnZSh0aGlzLmNvbmZpZy5zZXNzaW9uTmFtZSlcclxuXHJcbiAgLy8gbG9hZERpdnMgcmVwbGFjZXMgZWFjaCBUb25pY1BvdyBkaXYgd2l0aCBhIGNvcnJlc3BvbmRpbmcgZW1iZWQgd2lkZ2V0XHJcbiAgbG9hZERpdnMgPSBhc3luYyAoKSA9PiB7XHJcbiAgICAvLyBHZXQgYWxsIGRpdnNcclxuICAgIGNvbnN0IHRvbmljRGl2cyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUodGhpcy5jb25maWcud2lkZ2V0RGl2Q2xhc3MpXHJcblxyXG4gICAgLy8gTG9vcCBhbGwgZGl2cyB0aGF0IHdlIGZvdW5kXHJcbiAgICBmb3IgKGxldCBpID0gdG9uaWNEaXZzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XHJcbiAgICAgIC8vIFNldCB0aGUgZGl2XHJcbiAgICAgIGNvbnN0IHRvbmljRGl2ID0gdG9uaWNEaXZzW2ldIGFzIEhUTUxEaXZFbGVtZW50XHJcblxyXG4gICAgICAvLyBOb3Qgc3VyZSB3aHkgdGhpcyBpcyBuZWVkZWQgYnV0IGVuY291bnRlcmVkIHRoaXMgaW4gcHJvZCAzLzUvMjAyMSAtIGx1a2VcclxuICAgICAgaWYgKCF0b25pY0Rpdikge1xyXG4gICAgICAgIGNvbnRpbnVlXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIEdldCB0aGUgd2lkZ2V0IGlkXHJcbiAgICAgIGNvbnN0IHdpZGdldElkID0gdG9uaWNEaXYuZ2V0QXR0cmlidXRlKHRoaXMuY29uZmlnLndpZGdldElkKVxyXG4gICAgICBpZiAoIXdpZGdldElkKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coYCR7d2lkZ2V0SWR9IG5vdCBmb3VuZGApXHJcbiAgICAgICAgY29udGludWVcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gR2V0IHRoZSBjdXN0b20gZW52aXJvbm1lbnQgKHN3aXRjaGluZyBhd2F5IGZyb20gZGVmYXVsdDogcHJvZHVjdGlvbilcclxuICAgICAgY29uc3QgY3VzdG9tRW52aXJvbm1lbnQgPSB0b25pY0Rpdi5nZXRBdHRyaWJ1dGUodGhpcy5jb25maWcuY3VzdG9tRW52aXJvbm1lbnQpXHJcbiAgICAgIHRoaXMuY29uZmlnLnNldEVudmlyb25tZW50KGN1c3RvbUVudmlyb25tZW50IHx8ICdwcm9kdWN0aW9uJylcclxuXHJcbiAgICAgIC8vIEFkZCB0byB3aWRnZXRzIG1hcFxyXG4gICAgICB0aGlzLndpZGdldHMuc2V0KHdpZGdldElkLCBudWxsKVxyXG5cclxuICAgICAgdHJ5IHtcclxuICAgICAgICAvLyBGaXJlIHRoZSByZXF1ZXN0IHRvIGxvYWQgdGhlIHdpZGdldCBkYXRhXHJcbiAgICAgICAgY29uc3QgcHJvbWlzZSA9IGF3YWl0IGZldGNoKFxyXG4gICAgICAgICAgYCR7dGhpcy5jb25maWcuYXBpVXJsfS92MS93aWRnZXRzL2Rpc3BsYXkvJHt3aWRnZXRJZH0/cHJvdmlkZXI9ZW1iZWQtJHt0aGlzLmNvbmZpZy52ZXJzaW9ufWBcclxuICAgICAgICApXHJcblxyXG4gICAgICAgIHZhciByZXNwb25zZVxyXG4gICAgICAgIGlmIChwcm9taXNlLnN0YXR1cyA9PT0gNDAzKSB7XHJcbiAgICAgICAgICBjb25zb2xlLmluZm8oYCR7cHJvbWlzZS5zdGF0dXN9OiBEb21haW4gbm90IGFsbG93ZWRgKVxyXG4gICAgICAgICAgcmVzcG9uc2UgPSB7XHJcbiAgICAgICAgICAgIGxpbmtfdXJsOiAnaHR0cHM6Ly90b25pY3Bvdy5jb20nLFxyXG4gICAgICAgICAgICBpbWFnZV91cmw6IGZhbGxiYWNrSW1hZ2UsXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHJlc3BvbnNlID0gYXdhaXQgcHJvbWlzZS5qc29uKClcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFNldCBVUkkgZW5jb2RlZCB0aXRsZVxyXG4gICAgICAgIGNvbnN0IGNhbXBhaWduVGl0bGUgPSBlbmNvZGVVUklDb21wb25lbnQocmVzcG9uc2UudGl0bGUpXHJcblxyXG4gICAgICAgIC8vIFNldCB0aGUgSFRNTFxyXG4gICAgICAgIHRvbmljRGl2LmlubmVySFRNTCA9IGBcclxuICAgICAgPGEgaHJlZj1cIiR7cmVzcG9uc2UubGlua191cmx9P3V0bV9zb3VyY2U9dG9uaWNwb3ctd2lkZ2V0cyZ1dG1fbWVkaXVtPXdpZGdldCZ1dG1fY2FtcGFpZ249JHt3aWRnZXRJZH0mdXRtX2NvbnRlbnQ9JHtjYW1wYWlnblRpdGxlfVwiIHN0eWxlPVwiZGlzcGxheTogYmxvY2tcIj5cclxuICAgICAgPGltZyBzcmM9XCIke3Jlc3BvbnNlLmltYWdlX3VybH1cIiBcclxuICAgICAgaWQ9XCIke3dpZGdldElkfVwiXHJcbiAgICAgIHdpZHRoPVwiJHtyZXNwb25zZS53aWR0aH1cIiBcclxuICAgICAgaGVpZ2h0PVwiJHtyZXNwb25zZS5oZWlnaHR9XCIgXHJcbiAgICAgIGFsdD1cIiR7cmVzcG9uc2UudGl0bGV9XCIgLz5cclxuICAgICAgPC9hPmBcclxuICAgICAgICAvLyBTZXQgYWRkaXRpb25hbCBpbmZvcm1hdGlvblxyXG4gICAgICAgIHRvbmljRGl2LnNldEF0dHJpYnV0ZSgnZGF0YS13aWR0aCcsIHJlc3BvbnNlLndpZHRoKVxyXG4gICAgICAgIHRvbmljRGl2LnNldEF0dHJpYnV0ZSgnZGF0YS1oZWlnaHQnLCByZXNwb25zZS5oZWlnaHQpXHJcblxyXG4gICAgICAgIC8vIEFkZCB0byB3aWRnZXRzIG1hcFxyXG4gICAgICAgIHRoaXMud2lkZ2V0cy5zZXQod2lkZ2V0SWQsIHJlc3BvbnNlIGFzIHR5cGVvZiBXaWRnZXQpXHJcbiAgICAgICAgLy8gQW5ub3lpbmcgdGhhdCB0aGlzIGlzIG5lZWRlZCBidXQgSSBjYW4ndCBlZmZlY3RpdmVseSBvYnNlcnZlIHRoZSBtYXBcclxuICAgICAgICBpZiAodGhpcy5vcHRpb25zICYmIHRoaXMub3B0aW9ucy53aWRnZXRzQ2hhbmdlZENhbGxiYWNrKSB7XHJcbiAgICAgICAgICB0aGlzLm9wdGlvbnMud2lkZ2V0c0NoYW5nZWRDYWxsYmFjayh3aWRnZXRJZCwgcmVzcG9uc2UgYXMgdHlwZW9mIFdpZGdldClcclxuICAgICAgICB9XHJcbiAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICB0aHJvdyBlXHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIExvYWQgdGhlIFRvbmljUG93IHNjcmlwdChzKSBhbmQgZGVmYXVsdCBzZXR0aW5nc1xyXG4gIGxvYWQgPSBhc3luYyAoKSA9PiB7XHJcbiAgICAvLyBXZSBvbmx5IHdvcmsgaW4gYSBicm93c2VyXHJcbiAgICBpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignVG9uaWNQb3cgZW1iZWQgb25seSB3b3JrcyBpbiB0aGUgYnJvd3NlcicpXHJcbiAgICAgIHJldHVyblxyXG4gICAgfVxyXG5cclxuICAgIC8vIExvYWQgYWxsIHRvbmljcyBmb3VuZCBvbiB0aGUgcGFnZSAoaWYgd2UgaGF2ZSBkaXYpXHJcbiAgICBjb25zdCB0b25pY0RpdnMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKHRoaXMuY29uZmlnLndpZGdldERpdkNsYXNzKVxyXG4gICAgaWYgKHRvbmljRGl2cyAmJiB0b25pY0RpdnMubGVuZ3RoID4gMCkge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGF3YWl0IHRoaXMubG9hZERpdnMoKVxyXG4gICAgICAgIGNvbnNvbGUubG9nKCclYyBUb25pY1BvdyB3aWRnZXQocykgbG9hZGVkISAnLCAnYmFja2dyb3VuZDogIzk3NENEMjsgY29sb3I6ICNmZmYnKVxyXG4gICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgdGhyb3cgZVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gUHJvY2VzcyB2aXNpdG9yIHRva2VuXHJcbiAgICBjb25zdCBzZXNzaW9uID0gdGhpcy5jYXB0dXJlVmlzaXRvclNlc3Npb24oKVxyXG5cclxuICAgIC8vIENhcHR1cmUgZXZlbnRzIGlmIHdlIGhhdmUgYSBzZXNzaW9uXHJcbiAgICBpZiAoc2Vzc2lvbikge1xyXG4gICAgICB0aGlzLmV2ZW50cyA9IG5ldyBFdmVudHMoc2Vzc2lvbilcclxuICAgIH1cclxuICB9XHJcbn1cclxudmFyIHRwb3dcclxudHJ5IHtcclxuICB0cG93ID0gbmV3IFRvbmljUG93KClcclxufSBjYXRjaCAoZSkge1xyXG4gIGNvbnNvbGUubG9nKCdlcnJybWFnb3JkJywgZSlcclxufVxyXG5cclxuOyh3aW5kb3cgYXMgYW55KS5Ub25pY1BvdyA9IHRwb3cgfHwge31cclxuLy8gQXV0by1sb2FkIGFuZCBzZXQgb24gd2luZG93XHJcbiIsIi8qIGdsb2JhbCBsb2NhbFN0b3JhZ2UgKi9cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFN0b3JhZ2Uge1xyXG4gIC8qXHJcbiAgcmVtb3ZlU3RvcmFnZTogcmVtb3ZlcyBhIGtleSBmcm9tIGxvY2FsU3RvcmFnZSBhbmQgaXRzIHNpYmxpbmcgZXhwaXJhY3kga2V5XHJcbiAgcGFyYW1zOlxyXG4gICAgICBrZXkgPHN0cmluZz4gOiBsb2NhbFN0b3JhZ2Uga2V5IHRvIHJlbW92ZVxyXG4gIHJldHVybnM6XHJcbiAgICAgIDxib29sZWFuPiA6IHRlbGxpbmcgaWYgb3BlcmF0aW9uIHN1Y2NlZWRlZFxyXG4gICovXHJcbiAgcmVtb3ZlU3RvcmFnZSA9IChuYW1lOiBzdHJpbmcpID0+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKG5hbWUpXHJcbiAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKGAke25hbWV9X2V4cGlyZXNJbmApXHJcbiAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKFxyXG4gICAgICAgIGByZW1vdmVTdG9yYWdlOiBFcnJvciByZW1vdmluZyBrZXkgWyR7bmFtZX1dIGZyb20gbG9jYWxTdG9yYWdlOiAke0pTT04uc3RyaW5naWZ5KGUpfWBcclxuICAgICAgKVxyXG4gICAgICByZXR1cm4gZmFsc2VcclxuICAgIH1cclxuICAgIHJldHVybiB0cnVlXHJcbiAgfVxyXG5cclxuICAvKlxyXG4gIGdldFN0b3JhZ2U6IHJldHJpZXZlcyBhIGtleSBmcm9tIGxvY2FsU3RvcmFnZSBwcmV2aW91c2x5IHNldCB3aXRoIHNldFN0b3JhZ2UoKS5cclxuICBwYXJhbXM6XHJcbiAgICAgIGtleSA8c3RyaW5nPiA6IGxvY2FsU3RvcmFnZSBrZXlcclxuICByZXR1cm5zOlxyXG4gICAgICA8c3RyaW5nPiA6IHZhbHVlIG9mIGxvY2FsU3RvcmFnZSBrZXlcclxuICAgICAgbnVsbCA6IGluIGNhc2Ugb2YgZXhwaXJlZCBrZXkgb3IgZmFpbHVyZVxyXG4gICovXHJcbiAgZ2V0U3RvcmFnZSA9IChrZXk6IHN0cmluZykgPT4ge1xyXG4gICAgLy8gZXBvY2ggdGltZSwgbGV0cyBkZWFsIG9ubHkgd2l0aCBpbnRlZ2VyXHJcbiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpXHJcblxyXG4gICAgLy8gU2V0IGV4cGlyYXRpb24gZm9yIHN0b3JhZ2VcclxuICAgIGxldCBleHBpcmVzXHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgZXhwaXJlcyA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKGAke2tleX1fZXhwaXJlc2ApXHJcbiAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBnZXRJdGVtOiBlcnJvciBnZXR0aW5nIGxvY2FsU3RvcmFnZTogJHtKU09OLnN0cmluZ2lmeShlKX1gKVxyXG4gICAgICByZXR1cm4gbnVsbFxyXG4gICAgfVxyXG5cclxuICAgIGlmIChleHBpcmVzID09PSB1bmRlZmluZWQgfHwgZXhwaXJlcyA9PT0gbnVsbCkge1xyXG4gICAgICBleHBpcmVzID0gMFxyXG4gICAgfVxyXG5cclxuICAgIC8vIEV4cGlyZWRcclxuICAgIGlmIChleHBpcmVzIDwgbm93KSB7XHJcbiAgICAgIHRoaXMucmVtb3ZlU3RvcmFnZShrZXkpXHJcbiAgICAgIHJldHVybiBudWxsXHJcbiAgICB9XHJcblxyXG4gICAgLy8gR2V0IHRoZSBleGlzdGluZyBpdGVtXHJcbiAgICB0cnkge1xyXG4gICAgICByZXR1cm4gbG9jYWxTdG9yYWdlLmdldEl0ZW0oa2V5KVxyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICBjb25zb2xlLmxvZyhgZ2V0U3RvcmFnZTogRXJyb3IgcmVhZGluZyBrZXkgWyR7a2V5fV0gZnJvbSBsb2NhbFN0b3JhZ2U6ICR7SlNPTi5zdHJpbmdpZnkoZSl9YClcclxuICAgICAgcmV0dXJuIG51bGxcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qXHJcbiAgc2V0U3RvcmFnZTogd3JpdGVzIGEga2V5IGludG8gbG9jYWxTdG9yYWdlIHNldHRpbmcgYSBleHBpcmUgdGltZVxyXG4gIHBhcmFtczpcclxuICAgICAga2V5IDxzdHJpbmc+ICAgICA6IGxvY2FsU3RvcmFnZSBrZXlcclxuICAgICAgdmFsdWUgPHN0cmluZz4gICA6IGxvY2FsU3RvcmFnZSB2YWx1ZVxyXG4gICAgICBleHBpcmVzIDxudW1iZXI+IDogbnVtYmVyIG9mIHNlY29uZHMgZnJvbSBub3cgdG8gZXhwaXJlIHRoZSBrZXlcclxuICByZXR1cm5zOlxyXG4gICAgICA8Ym9vbGVhbj4gOiB0ZWxsaW5nIGlmIG9wZXJhdGlvbiBzdWNjZWVkZWRcclxuICAqL1xyXG4gIHNldFN0b3JhZ2UgPSAoa2V5OiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcsIGV4cGlyZXM6IG51bWJlciB8IG51bGwgPSBudWxsKSA9PiB7XHJcbiAgICAvLyBFeHBpcmVkIHRpbWVcclxuICAgIGlmIChleHBpcmVzKSB7XHJcbiAgICAgIGV4cGlyZXMgPSBNYXRoLmFicyhleHBpcmVzKSAvLyBtYWtlIHN1cmUgaXQncyBwb3NpdGl2ZVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgZXhwaXJlcyA9IDI0ICogNjAgKiA2MCAvLyBkZWZhdWx0OiBzZWNvbmRzIGZvciAxIGRheVxyXG4gICAgfVxyXG5cclxuICAgIC8vIE1pbGxpIHNlY29uZHMgc2luY2UgZXBvY2ggdGltZSwgbGV0cyBkZWFsIG9ubHkgd2l0aCBpbnRlZ2VyXHJcbiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpXHJcbiAgICBjb25zdCBzY2hlZHVsZSA9IG5vdyArIGV4cGlyZXMgKiAxMDAwXHJcbiAgICB0cnkge1xyXG4gICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShrZXksIHZhbHVlKVxyXG4gICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShgJHtrZXl9X2V4cGlyZXNgLCBzY2hlZHVsZS50b1N0cmluZygpKVxyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICBjb25zb2xlLmxvZyhgc2V0U3RvcmFnZTogRXJyb3Igc2V0dGluZyBrZXkgWyR7a2V5fV0gaW4gbG9jYWxTdG9yYWdlOiAke0pTT04uc3RyaW5naWZ5KGUpfWApXHJcbiAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRydWVcclxuICB9XHJcbn1cclxuIiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0aWYoX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSkge1xuXHRcdHJldHVybiBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4iLCIvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9ucyBmb3IgaGFybW9ueSBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSAoZXhwb3J0cywgZGVmaW5pdGlvbikgPT4ge1xuXHRmb3IodmFyIGtleSBpbiBkZWZpbml0aW9uKSB7XG5cdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGRlZmluaXRpb24sIGtleSkgJiYgIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBrZXkpKSB7XG5cdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZGVmaW5pdGlvbltrZXldIH0pO1xuXHRcdH1cblx0fVxufTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLmcgPSAoZnVuY3Rpb24oKSB7XG5cdGlmICh0eXBlb2YgZ2xvYmFsVGhpcyA9PT0gJ29iamVjdCcpIHJldHVybiBnbG9iYWxUaGlzO1xuXHR0cnkge1xuXHRcdHJldHVybiB0aGlzIHx8IG5ldyBGdW5jdGlvbigncmV0dXJuIHRoaXMnKSgpO1xuXHR9IGNhdGNoIChlKSB7XG5cdFx0aWYgKHR5cGVvZiB3aW5kb3cgPT09ICdvYmplY3QnKSByZXR1cm4gd2luZG93O1xuXHR9XG59KSgpOyIsIl9fd2VicGFja19yZXF1aXJlX18ubyA9IChvYmosIHByb3ApID0+IChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKSkiLCIvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSAoZXhwb3J0cykgPT4ge1xuXHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcblx0fVxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xufTsiLCJ2YXIgc2NyaXB0VXJsO1xuaWYgKF9fd2VicGFja19yZXF1aXJlX18uZy5pbXBvcnRTY3JpcHRzKSBzY3JpcHRVcmwgPSBfX3dlYnBhY2tfcmVxdWlyZV9fLmcubG9jYXRpb24gKyBcIlwiO1xudmFyIGRvY3VtZW50ID0gX193ZWJwYWNrX3JlcXVpcmVfXy5nLmRvY3VtZW50O1xuaWYgKCFzY3JpcHRVcmwgJiYgZG9jdW1lbnQpIHtcblx0aWYgKGRvY3VtZW50LmN1cnJlbnRTY3JpcHQpXG5cdFx0c2NyaXB0VXJsID0gZG9jdW1lbnQuY3VycmVudFNjcmlwdC5zcmNcblx0aWYgKCFzY3JpcHRVcmwpIHtcblx0XHR2YXIgc2NyaXB0cyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwic2NyaXB0XCIpO1xuXHRcdGlmKHNjcmlwdHMubGVuZ3RoKSBzY3JpcHRVcmwgPSBzY3JpcHRzW3NjcmlwdHMubGVuZ3RoIC0gMV0uc3JjXG5cdH1cbn1cbi8vIFdoZW4gc3VwcG9ydGluZyBicm93c2VycyB3aGVyZSBhbiBhdXRvbWF0aWMgcHVibGljUGF0aCBpcyBub3Qgc3VwcG9ydGVkIHlvdSBtdXN0IHNwZWNpZnkgYW4gb3V0cHV0LnB1YmxpY1BhdGggbWFudWFsbHkgdmlhIGNvbmZpZ3VyYXRpb25cbi8vIG9yIHBhc3MgYW4gZW1wdHkgc3RyaW5nIChcIlwiKSBhbmQgc2V0IHRoZSBfX3dlYnBhY2tfcHVibGljX3BhdGhfXyB2YXJpYWJsZSBmcm9tIHlvdXIgY29kZSB0byB1c2UgeW91ciBvd24gbG9naWMuXG5pZiAoIXNjcmlwdFVybCkgdGhyb3cgbmV3IEVycm9yKFwiQXV0b21hdGljIHB1YmxpY1BhdGggaXMgbm90IHN1cHBvcnRlZCBpbiB0aGlzIGJyb3dzZXJcIik7XG5zY3JpcHRVcmwgPSBzY3JpcHRVcmwucmVwbGFjZSgvIy4qJC8sIFwiXCIpLnJlcGxhY2UoL1xcPy4qJC8sIFwiXCIpLnJlcGxhY2UoL1xcL1teXFwvXSskLywgXCIvXCIpO1xuX193ZWJwYWNrX3JlcXVpcmVfXy5wID0gc2NyaXB0VXJsOyIsIi8vIHN0YXJ0dXBcbi8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuLy8gVGhpcyBlbnRyeSBtb2R1bGUgaXMgcmVmZXJlbmNlZCBieSBvdGhlciBtb2R1bGVzIHNvIGl0IGNhbid0IGJlIGlubGluZWRcbnZhciBfX3dlYnBhY2tfZXhwb3J0c19fID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2MDcpO1xuIl0sInNvdXJjZVJvb3QiOiIifQ==