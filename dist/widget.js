(()=>{var t={913:(t,e,i)=>{var n;void 0===(n=function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(){this.isEnvironmentValid=t=>this.environments.includes(t),this.setEnvironment=t=>{t&&this.isEnvironmentValid(t)&&(this.environment=t,t===this.environmentStaging?(this.apiUrl=this.apiUrlStaging,this.eventsUrl=this.eventsUrlStaging):t===this.environmentLocal?(this.apiUrl=this.apiUrlLocal,this.eventsUrl=this.eventsUrlLocal):t===this.environmentProduction&&(this.apiUrl=this.apiUrlProduction,this.eventsUrl=this.eventsUrlProduction))},this.environmentLocal="local",this.environmentStaging="staging",this.environmentProduction="production",this.apiUrl="https://api.tonicpow.com",this.apiUrlLocal="http://localhost:3000",this.apiUrlStaging="https://api.staging.tonicpow.com",this.apiUrlProduction="https://api.tonicpow.com",this.eventsUrl="https://events.tonicpow.com",this.eventsUrlLocal="http://localhost:3002",this.eventsUrlStaging="https://events.staging.tonicpow.com",this.eventsUrlProduction="https://events.tonicpow.com",this.customEnvironment="data-environment",this.environment="",this.environments=[this.environmentLocal,this.environmentStaging,this.environmentProduction],this.maxSessionDays=60,this.sessionName="tncpw_session",this.version="v0.0.8",this.widgetDivClass="tonicpow-widget",this.widgetId="data-widget-id"}}}.apply(e,[i,e]))||(t.exports=n)},242:function(t,e,i){var n,o,s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};n=[i,e,i(913)],void 0===(o=function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i=s(i),e.default=class{constructor(t){this.detectWidgetClick=()=>{document.addEventListener("click",(async t=>{if(((t=t||window.event).target||t.srcElement)?.parentElement?.parentElement?.classList?.contains("tonicpow-widget"))try{this.interactionSent=!0,await this.sendEvent("interaction","click")}catch(t){console.error("failed to report interaction: click",t)}}))},this.detectBounce=()=>{window.onbeforeunload=()=>{this.sendEvent("bounce",((new Date).getTime()-this.start).toString())}},this.detectInteraction=()=>{document.addEventListener("mousedown",(async()=>{if(!this.interactionSent)try{await this.sendEvent("interaction","mousedown"),this.interactionSent=!0}catch(t){console.error("failed to report interaction: mousedown",t)}})),document.addEventListener("scroll",(async()=>{if(!this.interactionSent)try{await this.sendEvent("interaction","scroll"),this.interactionSent=!0}catch(t){console.error("failed to report interaction: scroll",t)}})),document.addEventListener("keypress",(async()=>{if(!this.interactionSent)try{await this.sendEvent("interaction","keypress"),this.interactionSent=!0}catch(t){console.error("failed to report interaction: keypress",t)}}))},this.sendEvent=async(t,e)=>{if(!this.sessionId)return void console.info("you must call init with a session before sending events");let n=new i.default;await fetch(`${n.eventsUrl}/v1/events?v=${n.version}&name=${t}&tncpw_session=${this.sessionId}&data=${e}`,{method:"get"})},this.sessionId=t,this.interactionSent=!1,this.start=(new Date).getTime(),this.detectInteraction(),this.detectBounce(),this.detectWidgetClick()}}}.apply(e,n))||(t.exports=o)},607:function(t,e,i){var n,o,s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};n=[i,e,i(913),i(242),i(912)],void 0===(o=function(t,e,i,n,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i=s(i),n=s(n),o=s(o);const r={AutoInit:!0,WidgetRequestCallback:t=>{}};class a{constructor(t=r){this.registerEvents=()=>{if(!this.events){let t=this.getVisitorSession();t&&(console.log("registering session",t),this.events=new n.default(t))}},this.setOreo=(t,e,i)=>{const n=new Date;n.setTime(n.getTime()+864e5*i),document.cookie=`${t}=${e};path=/;expires=${n.toUTCString()}`},this.captureVisitorSession=(t="")=>{let e=t;return t&&t.length||"undefined"==typeof window||(e=new URLSearchParams(window.location.search).get(this.config.sessionName)||""),e&&e.length>0?(this.setOreo(this.config.sessionName,e,this.config.maxSessionDays),this.storage.setStorage(this.config.sessionName,e,86400*this.config.maxSessionDays),e):null},this.getVisitorSession=()=>this.storage.getStorage(this.config.sessionName),this.loadDivs=async()=>{const t=document.getElementsByClassName(this.config.widgetDivClass);for(let e=t.length-1;e>=0;e--){const i=t[e],n=i.getAttribute(this.config.widgetId);if(!n){console.log(`${n} not found`);continue}const o=i.getAttribute(this.config.customEnvironment);this.config.setEnvironment(o||"production");const s=await fetch(`${this.config.apiUrl}/v1/widgets/display/${n}?provider=embed-${this.config.version}`),r=await s.json();console.log("firing callback"),this.options.WidgetRequestCallback(r);const a=encodeURIComponent(r.title);i.innerHTML=`\n    <a href="${r.link_url}?utm_source=tonicpow-widgets&utm_medium=widget&utm_campaign=${n}&utm_content=${a}" style="display: block">\n      <img src="${r.image_url}" \n      id="${n}"\n      width="${r.width}" \n      height="${r.height}" \n      alt="${r.title}" />\n    </a>`,i.setAttribute("data-width",r.width),i.setAttribute("data-height",r.height)}},this.load=()=>{if("undefined"==typeof window)return void console.error("TonicPow embed only works in the browser");const t=document.getElementsByClassName(this.config.widgetDivClass);t&&t.length>0&&this.loadDivs().then((()=>{console.log("TonicPow widget(s) loaded!")}));const e=this.captureVisitorSession();e&&(this.events=new n.default(e))},this.options=t;for(let[e,i]of Object.entries(t))Object.defineProperty(this.options,e,{value:i,writable:!1});console.log("constructed",this),this.config=new i.default,this.storage=new o.default,this.options.AutoInit&&("complete"===document.readyState||"interactive"===document.readyState?(this.load(),this.registerEvents()):document.addEventListener("DOMContentLoaded",(()=>{this.load(),this.registerEvents()})))}}e.default=a,window.TonicPow=a||{}}.apply(e,n))||(t.exports=o)},912:(t,e,i)=>{var n;void 0===(n=function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(){this.removeStorage=t=>{try{localStorage.removeItem(t),localStorage.removeItem(`${t}_expiresIn`)}catch(e){return console.log(`removeStorage: Error removing key [${t}] from localStorage: ${JSON.stringify(e)}`),!1}return!0},this.getStorage=t=>{const e=Date.now();let i;try{i=localStorage.getItem(`${t}_expires`)}catch(t){return console.log(`getItem: error getting localStorage: ${JSON.stringify(t)}`),null}if(null==i&&(i=0),i<e)return this.removeStorage(t),null;try{return localStorage.getItem(t)}catch(e){return console.log(`getStorage: Error reading key [${t}] from localStorage: ${JSON.stringify(e)}`),null}},this.setStorage=(t,e,i=null)=>{i=i?Math.abs(i):86400;const n=Date.now()+1e3*i;try{localStorage.setItem(t,e),localStorage.setItem(`${t}_expires`,n.toString())}catch(e){return console.log(`setStorage: Error setting key [${t}] in localStorage: ${JSON.stringify(e)}`),!1}return!0}}}}.apply(e,[i,e]))||(t.exports=n)}},e={};!function i(n){if(e[n])return e[n].exports;var o=e[n]={exports:{}};return t[n].call(o.exports,o,o.exports,i),o.exports}(607)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9AdG9uaWNwb3cvd2lkZ2V0Ly4vc3JjL2NvbmZpZy50cyIsIndlYnBhY2s6Ly9AdG9uaWNwb3cvd2lkZ2V0Ly4vc3JjL2V2ZW50cy50cyIsIndlYnBhY2s6Ly9AdG9uaWNwb3cvd2lkZ2V0Ly4vc3JjL2luZGV4LnRzIiwid2VicGFjazovL0B0b25pY3Bvdy93aWRnZXQvLi9zcmMvc3RvcmFnZS50cyIsIndlYnBhY2s6Ly9AdG9uaWNwb3cvd2lkZ2V0L3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL0B0b25pY3Bvdy93aWRnZXQvd2VicGFjay9zdGFydHVwIl0sIm5hbWVzIjpbImlzRW52aXJvbm1lbnRWYWxpZCIsImVudmlyb25tZW50IiwidGhpcyIsImVudmlyb25tZW50cyIsImluY2x1ZGVzIiwic2V0RW52aXJvbm1lbnQiLCJlbnZpcm9ubWVudFN0YWdpbmciLCJhcGlVcmwiLCJhcGlVcmxTdGFnaW5nIiwiZXZlbnRzVXJsIiwiZXZlbnRzVXJsU3RhZ2luZyIsImVudmlyb25tZW50TG9jYWwiLCJhcGlVcmxMb2NhbCIsImV2ZW50c1VybExvY2FsIiwiZW52aXJvbm1lbnRQcm9kdWN0aW9uIiwiYXBpVXJsUHJvZHVjdGlvbiIsImV2ZW50c1VybFByb2R1Y3Rpb24iLCJjdXN0b21FbnZpcm9ubWVudCIsIm1heFNlc3Npb25EYXlzIiwic2Vzc2lvbk5hbWUiLCJ2ZXJzaW9uIiwid2lkZ2V0RGl2Q2xhc3MiLCJ3aWRnZXRJZCIsInNlc3Npb25JZCIsImRldGVjdFdpZGdldENsaWNrIiwiZG9jdW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiYXN5bmMiLCJlIiwid2luZG93IiwiZXZlbnQiLCJ0YXJnZXQiLCJzcmNFbGVtZW50IiwicGFyZW50RWxlbWVudCIsImNsYXNzTGlzdCIsImNvbnRhaW5zIiwiaW50ZXJhY3Rpb25TZW50Iiwic2VuZEV2ZW50IiwiY29uc29sZSIsImVycm9yIiwiZGV0ZWN0Qm91bmNlIiwib25iZWZvcmV1bmxvYWQiLCJEYXRlIiwiZ2V0VGltZSIsInN0YXJ0IiwidG9TdHJpbmciLCJkZXRlY3RJbnRlcmFjdGlvbiIsImV2ZW50TmFtZSIsImRhdGEiLCJpbmZvIiwiY29uZmlnIiwiZmV0Y2giLCJtZXRob2QiLCJkZWZhdWx0T3B0aW9ucyIsIkF1dG9Jbml0IiwiV2lkZ2V0UmVxdWVzdENhbGxiYWNrIiwid2lkZ2V0IiwiVG9uaWNQb3ciLCJvcHRpb25zIiwicmVnaXN0ZXJFdmVudHMiLCJldmVudHMiLCJzZXNzaW9uIiwiZ2V0VmlzaXRvclNlc3Npb24iLCJsb2ciLCJzZXRPcmVvIiwibmFtZSIsInZhbHVlIiwiZGF5cyIsImRhdGUiLCJzZXRUaW1lIiwiY29va2llIiwidG9VVENTdHJpbmciLCJjYXB0dXJlVmlzaXRvclNlc3Npb24iLCJjdXN0b21TZXNzaW9uSWQiLCJsZW5ndGgiLCJVUkxTZWFyY2hQYXJhbXMiLCJsb2NhdGlvbiIsInNlYXJjaCIsImdldCIsInN0b3JhZ2UiLCJzZXRTdG9yYWdlIiwiZ2V0U3RvcmFnZSIsImxvYWREaXZzIiwidG9uaWNEaXZzIiwiZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSIsImkiLCJ0b25pY0RpdiIsImdldEF0dHJpYnV0ZSIsInByb21pc2UiLCJyZXNwb25zZSIsImpzb24iLCJjYW1wYWlnblRpdGxlIiwiZW5jb2RlVVJJQ29tcG9uZW50IiwidGl0bGUiLCJpbm5lckhUTUwiLCJsaW5rX3VybCIsImltYWdlX3VybCIsIndpZHRoIiwiaGVpZ2h0Iiwic2V0QXR0cmlidXRlIiwibG9hZCIsInRoZW4iLCJvcHRpb25LZXkiLCJvcHRpb25WYWwiLCJPYmplY3QiLCJlbnRyaWVzIiwiZGVmaW5lUHJvcGVydHkiLCJ3cml0YWJsZSIsInJlYWR5U3RhdGUiLCJyZW1vdmVTdG9yYWdlIiwibG9jYWxTdG9yYWdlIiwicmVtb3ZlSXRlbSIsIkpTT04iLCJzdHJpbmdpZnkiLCJrZXkiLCJub3ciLCJleHBpcmVzIiwiZ2V0SXRlbSIsIk1hdGgiLCJhYnMiLCJzY2hlZHVsZSIsInNldEl0ZW0iLCJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiX193ZWJwYWNrX21vZHVsZXNfXyIsImNhbGwiXSwibWFwcGluZ3MiOiJ5SEFBQSxnQkFxQkUsY0F3QkEsS0FBQUEsbUJBQXNCQyxHQUF3QkMsS0FBS0MsYUFBYUMsU0FBU0gsR0FHekUsS0FBQUksZUFBa0JKLElBRVhBLEdBS0FDLEtBQUtGLG1CQUFtQkMsS0FLN0JDLEtBQUtELFlBQWNBLEVBR2ZBLElBQWdCQyxLQUFLSSxvQkFDdkJKLEtBQUtLLE9BQVNMLEtBQUtNLGNBQ25CTixLQUFLTyxVQUFZUCxLQUFLUSxrQkFDYlQsSUFBZ0JDLEtBQUtTLGtCQUM5QlQsS0FBS0ssT0FBU0wsS0FBS1UsWUFDbkJWLEtBQUtPLFVBQVlQLEtBQUtXLGdCQUNiWixJQUFnQkMsS0FBS1ksd0JBQzlCWixLQUFLSyxPQUFTTCxLQUFLYSxpQkFDbkJiLEtBQUtPLFVBQVlQLEtBQUtjLHVCQWpEeEJkLEtBQUtTLGlCQUFtQixRQUN4QlQsS0FBS0ksbUJBQXFCLFVBQzFCSixLQUFLWSxzQkFBd0IsYUFFN0JaLEtBQUtLLE9BQVMsMkJBQ2RMLEtBQUtVLFlBQWMsd0JBQ25CVixLQUFLTSxjQUFnQixtQ0FDckJOLEtBQUthLGlCQUFtQiwyQkFDeEJiLEtBQUtPLFVBQVksOEJBQ2pCUCxLQUFLVyxlQUFpQix3QkFDdEJYLEtBQUtRLGlCQUFtQixzQ0FDeEJSLEtBQUtjLG9CQUFzQiw4QkFDM0JkLEtBQUtlLGtCQUFvQixtQkFDekJmLEtBQUtELFlBQWMsR0FDbkJDLEtBQUtDLGFBQWUsQ0FBQ0QsS0FBS1MsaUJBQWtCVCxLQUFLSSxtQkFBb0JKLEtBQUtZLHVCQUMxRVosS0FBS2dCLGVBQWlCLEdBQ3RCaEIsS0FBS2lCLFlBQWMsZ0JBQ25CakIsS0FBS2tCLFFBQVUsU0FDZmxCLEtBQUttQixlQUFpQixrQkFDdEJuQixLQUFLb0IsU0FBVyxvQiw0UEN2Q3BCLGdCQUtFLFlB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ckYsTUFDakYsT0FhWCxLQUFBb0QsV0FBYSxDQUFDa0MsRUFBYWhELEVBQWVrRCxFQUF5QixRQUcvREEsRUFERUEsRUFDUUUsS0FBS0MsSUFBSUgsR0FFVCxNQUlaLE1BQ01JLEVBRE05RSxLQUFLeUUsTUFDZ0IsSUFBVkMsRUFDdkIsSUFDRU4sYUFBYVcsUUFBUVAsRUFBS2hELEdBQzFCNEMsYUFBYVcsUUFBUSxHQUFHUCxZQUFlTSxFQUFTM0UsWUFDaEQsTUFBT2pCLEdBRVAsT0FEQVUsUUFBUXlCLElBQUksa0NBQWtDbUQsdUJBQXlCRixLQUFLQyxVQUFVckYsT0FDL0UsRUFFVCxPQUFPLE0saUNDMUZQOEYsRUFBMkIsSUFHL0IsU0FBU0MsRUFBb0JDLEdBRTVCLEdBQUdGLEVBQXlCRSxHQUMzQixPQUFPRixFQUF5QkUsR0FBVUMsUUFHM0MsSUFBSUMsRUFBU0osRUFBeUJFLEdBQVksQ0FHakRDLFFBQVMsSUFPVixPQUhBRSxFQUFvQkgsR0FBVUksS0FBS0YsRUFBT0QsUUFBU0MsRUFBUUEsRUFBT0QsUUFBU0YsR0FHcEVHLEVBQU9ELFFDakJXRixDQUFvQixNIiwiZmlsZSI6IndpZGdldC5qcyIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIENvbmZpZyB7XHJcbiAgZW52aXJvbm1lbnRMb2NhbDogc3RyaW5nXHJcbiAgZW52aXJvbm1lbnRTdGFnaW5nOiBzdHJpbmdcclxuICBlbnZpcm9ubWVudFByb2R1Y3Rpb246IHN0cmluZ1xyXG4gIGFwaVVybDogc3RyaW5nXHJcbiAgYXBpVXJsTG9jYWw6IHN0cmluZ1xyXG4gIGFwaVVybFN0YWdpbmc6IHN0cmluZ1xyXG4gIGFwaVVybFByb2R1Y3Rpb246IHN0cmluZ1xyXG4gIGV2ZW50c1VybDogc3RyaW5nXHJcbiAgZXZlbnRzVXJsTG9jYWw6IHN0cmluZ1xyXG4gIGV2ZW50c1VybFN0YWdpbmc6IHN0cmluZ1xyXG4gIGV2ZW50c1VybFByb2R1Y3Rpb246IHN0cmluZ1xyXG4gIGN1c3RvbUVudmlyb25tZW50OiBzdHJpbmdcclxuICBlbnZpcm9ubWVudDogc3RyaW5nXHJcbiAgZW52aXJvbm1lbnRzOiBzdHJpbmdbXVxyXG4gIG1heFNlc3Npb25EYXlzOiBudW1iZXJcclxuICBzZXNzaW9uTmFtZTogc3RyaW5nXHJcbiAgdmVyc2lvbjogc3RyaW5nXHJcbiAgd2lkZ2V0RGl2Q2xhc3M6IHN0cmluZ1xyXG4gIHdpZGdldElkOiBzdHJpbmdcclxuXHJcbiAgY29uc3RydWN0b3IoKSB7XHJcbiAgICB0aGlzLmVudmlyb25tZW50TG9jYWwgPSAnbG9jYWwnXHJcbiAgICB0aGlzLmVudmlyb25tZW50U3RhZ2luZyA9ICdzdGFnaW5nJ1xyXG4gICAgdGhpcy5lbnZpcm9ubWVudFByb2R1Y3Rpb24gPSAncHJvZHVjdGlvbidcclxuXHJcbiAgICB0aGlzLmFwaVVybCA9ICdodHRwczovL2FwaS50b25pY3Bvdy5jb20nXHJcbiAgICB0aGlzLmFwaVVybExvY2FsID0gJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMCdcclxuICAgIHRoaXMuYXBpVXJsU3RhZ2luZyA9ICdodHRwczovL2FwaS5zdGFnaW5nLnRvbmljcG93LmNvbSdcclxuICAgIHRoaXMuYXBpVXJsUHJvZHVjdGlvbiA9ICdodHRwczovL2FwaS50b25pY3Bvdy5jb20nXHJcbiAgICB0aGlzLmV2ZW50c1VybCA9ICdodHRwczovL2V2ZW50cy50b25pY3Bvdy5jb20nXHJcbiAgICB0aGlzLmV2ZW50c1VybExvY2FsID0gJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMidcclxuICAgIHRoaXMuZXZlbnRzVXJsU3RhZ2luZyA9ICdodHRwczovL2V2ZW50cy5zdGFnaW5nLnRvbmljcG93LmNvbSdcclxuICAgIHRoaXMuZXZlbnRzVXJsUHJvZHVjdGlvbiA9ICdodHRwczovL2V2ZW50cy50b25pY3Bvdy5jb20nXHJcbiAgICB0aGlzLmN1c3RvbUVudmlyb25tZW50ID0gJ2RhdGEtZW52aXJvbm1lbnQnXHJcbiAgICB0aGlzLmVudmlyb25tZW50ID0gJydcclxuICAgIHRoaXMuZW52aXJvbm1lbnRzID0gW3RoaXMuZW52aXJvbm1lbnRMb2NhbCwgdGhpcy5lbnZpcm9ubWVudFN0YWdpbmcsIHRoaXMuZW52aXJvbm1lbnRQcm9kdWN0aW9uXVxyXG4gICAgdGhpcy5tYXhTZXNzaW9uRGF5cyA9IDYwXHJcbiAgICB0aGlzLnNlc3Npb25OYW1lID0gJ3RuY3B3X3Nlc3Npb24nXHJcbiAgICB0aGlzLnZlcnNpb24gPSAndjAuMC44J1xyXG4gICAgdGhpcy53aWRnZXREaXZDbGFzcyA9ICd0b25pY3Bvdy13aWRnZXQnXHJcbiAgICB0aGlzLndpZGdldElkID0gJ2RhdGEtd2lkZ2V0LWlkJ1xyXG4gIH1cclxuXHJcbiAgLy8gaXNFbnZpcm9ubWVudFZhbGlkIHdpbGwgY2hlY2sgaWYgdGhlIGdpdmVuIGVudmlyb25tZW50IGlzIHZhbGlkXHJcbiAgaXNFbnZpcm9ubWVudFZhbGlkID0gKGVudmlyb25tZW50OiBzdHJpbmcpID0+IHRoaXMuZW52aXJvbm1lbnRzLmluY2x1ZGVzKGVudmlyb25tZW50KVxyXG5cclxuICAvLyBzZXRFbnZpcm9ubWVudCB3aWxsIHNldCB0aGUgZW52aXJvbm1lbnRcclxuICBzZXRFbnZpcm9ubWVudCA9IChlbnZpcm9ubWVudDogc3RyaW5nKSA9PiB7XHJcbiAgICAvLyBObyBlbnZpcm9ubWVudCBzZXQ/IHVzZSB0aGUgZGVmYXVsdFxyXG4gICAgaWYgKCFlbnZpcm9ubWVudCkge1xyXG4gICAgICByZXR1cm5cclxuICAgIH1cclxuXHJcbiAgICAvLyBOb3QgYSB2YWxpZCBlbnZpcm9ubWVudD9cclxuICAgIGlmICghdGhpcy5pc0Vudmlyb25tZW50VmFsaWQoZW52aXJvbm1lbnQpKSB7XHJcbiAgICAgIHJldHVyblxyXG4gICAgfVxyXG5cclxuICAgIC8vIFNldCB0aGUgZW52aXJvbm1lbnRcclxuICAgIHRoaXMuZW52aXJvbm1lbnQgPSBlbnZpcm9ubWVudFxyXG5cclxuICAgIC8vIFNldCB0aGUgQVBJIHVybFxyXG4gICAgaWYgKGVudmlyb25tZW50ID09PSB0aGlzLmVudmlyb25tZW50U3RhZ2luZykge1xyXG4gICAgICB0aGlzLmFwaVVybCA9IHRoaXMuYXBpVXJsU3RhZ2luZ1xyXG4gICAgICB0aGlzLmV2ZW50c1VybCA9IHRoaXMuZXZlbnRzVXJsU3RhZ2luZ1xyXG4gICAgfSBlbHNlIGlmIChlbnZpcm9ubWVudCA9PT0gdGhpcy5lbnZpcm9ubWVudExvY2FsKSB7XHJcbiAgICAgIHRoaXMuYXBpVXJsID0gdGhpcy5hcGlVcmxMb2NhbFxyXG4gICAgICB0aGlzLmV2ZW50c1VybCA9IHRoaXMuZXZlbnRzVXJsTG9jYWxcclxuICAgIH0gZWxzZSBpZiAoZW52aXJvbm1lbnQgPT09IHRoaXMuZW52aXJvbm1lbnRQcm9kdWN0aW9uKSB7XHJcbiAgICAgIHRoaXMuYXBpVXJsID0gdGhpcy5hcGlVcmxQcm9kdWN0aW9uXHJcbiAgICAgIHRoaXMuZXZlbnRzVXJsID0gdGhpcy5ldmVudHNVcmxQcm9kdWN0aW9uXHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBDb25maWcgZnJvbSAnLi9jb25maWcnXHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBFdmVudHMge1xyXG4gIHNlc3Npb25JZDogc3RyaW5nXHJcbiAgc3RhcnQ6IG51bWJlclxyXG4gIGludGVyYWN0aW9uU2VudDogYm9vbGVhblxyXG5cclxuICBjb25zdHJ1Y3RvcihzZXNzaW9uSWQ6IHN0cmluZykge1xyXG4gICAgLy8gU2V0IHRoZSBjdXJyZW50IHNlc3Npb25cclxuICAgIHRoaXMuc2Vzc2lvbklkID0gc2Vzc2lvbklkXHJcblxyXG4gICAgdGhpcy5pbnRlcmFjdGlvblNlbnQgPSBmYWxzZVxyXG5cclxuICAgIC8vIFJlbWVtYmVyIHdoZW4gd2Ugc3RhcnRlZFxyXG4gICAgdGhpcy5zdGFydCA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpXHJcbiAgICB0aGlzLmRldGVjdEludGVyYWN0aW9uKClcclxuICAgIHRoaXMuZGV0ZWN0Qm91bmNlKClcclxuICAgIHRoaXMuZGV0ZWN0V2lkZ2V0Q2xpY2soKVxyXG4gIH1cclxuXHJcbiAgLy8gRGV0ZWN0cyBjbGljayBvbiB0aGUgd2lkZ2V0XHJcbiAgZGV0ZWN0V2lkZ2V0Q2xpY2sgPSAoKSA9PiB7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jIChlOiBFdmVudCkgPT4ge1xyXG4gICAgICBlID0gZSB8fCB3aW5kb3cuZXZlbnRcclxuICAgICAgdmFyIHRhcmdldCA9IChlLnRhcmdldCB8fCBlLnNyY0VsZW1lbnQpIGFzIEhUTUxEaXZFbGVtZW50XHJcbiAgICAgIC8vIEdldCBjb250YWluZXIgZnJvbSB0aGUgY2xpY2tlZCBlbGVtZW50XHJcbiAgICAgIGxldCBjb250YWluZXIgPSB0YXJnZXQ/LnBhcmVudEVsZW1lbnQ/LnBhcmVudEVsZW1lbnRcclxuICAgICAgLy8gU2VuZCBvbmx5IGlmIHdpZGdldCBpbWFnZSB3YXMgY2xpY2tlZFxyXG4gICAgICBpZiAoY29udGFpbmVyPy5jbGFzc0xpc3Q/LmNvbnRhaW5zKCd0b25pY3Bvdy13aWRnZXQnKSkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAvLyBLZWVwbyB0aGlzIGFib3ZlIHNlbmQgdG8gcHJldmVudCBzZW5kaW5nIG1vdXNlZG93biBBTkQgY2xpY2sgb24gaW5pdGlhbCBpbnRlcmFjdGlvblxyXG4gICAgICAgICAgdGhpcy5pbnRlcmFjdGlvblNlbnQgPSB0cnVlXHJcbiAgICAgICAgICBhd2FpdCB0aGlzLnNlbmRFdmVudCgnaW50ZXJhY3Rpb24nLCAnY2xpY2snKVxyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ2ZhaWxlZCB0byByZXBvcnQgaW50ZXJhY3Rpb246IGNsaWNrJywgZSlcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICAvLyBEZXRlY3RzIGEgYm91bmNlIGV2ZW50XHJcbiAgZGV0ZWN0Qm91bmNlID0gKCkgPT4ge1xyXG4gICAgd2luZG93Lm9uYmVmb3JldW5sb2FkID0gKCkgPT4ge1xyXG4gICAgICAvLyBDYWxjdWxhdGUgdGltZSBvbiBwYWdlXHJcbiAgICAgIHRoaXMuc2VuZEV2ZW50KCdib3VuY2UnLCAobmV3IERhdGUoKS5nZXRUaW1lKCkgLSB0aGlzLnN0YXJ0KS50b1N0cmluZygpKVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gRGV0ZWN0cyBhIHBhZ2UgaW50ZXJhY3Rpb25cclxuICBkZXRlY3RJbnRlcmFjdGlvbiA9ICgpID0+IHtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIGFzeW5jICgpID0+IHtcclxuICAgICAgaWYgKCF0aGlzLmludGVyYWN0aW9uU2VudCkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICBhd2FpdCB0aGlzLnNlbmRFdmVudCgnaW50ZXJhY3Rpb24nLCAnbW91c2Vkb3duJylcclxuICAgICAgICAgIHRoaXMuaW50ZXJhY3Rpb25TZW50ID0gdHJ1ZVxyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ2ZhaWxlZCB0byByZXBvcnQgaW50ZXJhY3Rpb246IG1vdXNlZG93bicsIGUpXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9KVxyXG5cclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIGFzeW5jICgpID0+IHtcclxuICAgICAgaWYgKCF0aGlzLmludGVyYWN0aW9uU2VudCkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICBhd2FpdCB0aGlzLnNlbmRFdmVudCgnaW50ZXJhY3Rpb24nLCAnc2Nyb2xsJylcclxuICAgICAgICAgIHRoaXMuaW50ZXJhY3Rpb25TZW50ID0gdHJ1ZVxyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ2ZhaWxlZCB0byByZXBvcnQgaW50ZXJhY3Rpb246IHNjcm9sbCcsIGUpXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9KVxyXG5cclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXByZXNzJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBpZiAoIXRoaXMuaW50ZXJhY3Rpb25TZW50KSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgIGF3YWl0IHRoaXMuc2VuZEV2ZW50KCdpbnRlcmFjdGlvbicsICdrZXlwcmVzcycpXHJcbiAgICAgICAgICB0aGlzLmludGVyYWN0aW9uU2VudCA9IHRydWVcclxuICAgICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCdmYWlsZWQgdG8gcmVwb3J0IGludGVyYWN0aW9uOiBrZXlwcmVzcycsIGUpXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgLy8gU2VuZCBldmVudCB3aWxsIHNlbmQgYW4gZXZlbnQgdG8gVG9uaWNQb3dcclxuICBzZW5kRXZlbnQgPSBhc3luYyAoZXZlbnROYW1lOiBzdHJpbmcsIGRhdGE6IHN0cmluZykgPT4ge1xyXG4gICAgaWYgKCF0aGlzLnNlc3Npb25JZCkge1xyXG4gICAgICBjb25zb2xlLmluZm8oJ3lvdSBtdXN0IGNhbGwgaW5pdCB3aXRoIGEgc2Vzc2lvbiBiZWZvcmUgc2VuZGluZyBldmVudHMnKVxyXG4gICAgICByZXR1cm5cclxuICAgIH1cclxuXHJcbiAgICAvLyBHZXQgY29uZmlnXHJcbiAgICBsZXQgY29uZmlnID0gbmV3IENvbmZpZygpXHJcblxyXG4gICAgLy8gdG9kbzogb2JmdXNjYXRlIHRoZSB1cmwgcGFyYW1zIChjaGFuZ2UgdG8gcGF5bG9hZCBvZiBKU09OPylcclxuICAgIGF3YWl0IGZldGNoKFxyXG4gICAgICBgJHtjb25maWcuZXZlbnRzVXJsfS92MS9ldmVudHM/dj0ke2NvbmZpZy52ZXJzaW9ufSZuYW1lPSR7ZXZlbnROYW1lfSZ0bmNwd19zZXNzaW9uPSR7dGhpcy5zZXNzaW9uSWR9JmRhdGE9JHtkYXRhfWAsXHJcbiAgICAgIHsgbWV0aG9kOiAnZ2V0JyB9XHJcbiAgICApXHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBDb25maWcgZnJvbSAnLi9jb25maWcnXHJcbmltcG9ydCBFdmVudHMgZnJvbSAnLi9ldmVudHMnXHJcbmltcG9ydCBTdG9yYWdlIGZyb20gJy4vc3RvcmFnZSdcclxuXHJcbi8vIGhlaWdodDogMjUwXHJcbi8vIGltYWdlX3VybDogXCJodHRwczovL3Jlcy5jbG91ZGluYXJ5LmNvbS90b25pY3Bvdy9pbWFnZS91cGxvYWQvY19jcm9wLHhfMCx5XzAsd18zMDAsaF8yNTAvd18zMDAsaF8yNTAsY19saW1pdCxnX2NlbnRlci92MTYwNjYyMjI0OC9vY3drZnNqc2IyaHoyb3N0eHlkbi5qcGdcIlxyXG4vLyBsaW5rX3VybDogXCJodHRwczovL3N0YWdpbmcudHBvdy5hcHAvYzFkMGY4YzlcIlxyXG4vLyB0aXRsZTogXCJTb21ldGhpbmcgY29vbFwiXHJcbi8vIHdpZHRoOiAzMDBcclxuaW50ZXJmYWNlIFdpZGdldCB7XHJcbiAgaGVpZ2h0OiBudW1iZXJcclxuICBpbWFnZV91cmw6IHN0cmluZ1xyXG4gIGxpbmtfdXJsOiBzdHJpbmdcclxuICB0aXRsZTogc3RyaW5nXHJcbiAgd2lkdGg6IG51bWJlclxyXG4gIGlkOiBudW1iZXJcclxufVxyXG5cclxuLy8gT3B0aW9ucyB3aGVuIGNyZWF0aW5nIGEgVG9uaWNQb3cgaW5zdGFuY2VcclxuaW50ZXJmYWNlIFRvbmljUG93T3B0aW9ucyB7XHJcbiAgQXV0b0luaXQ6IGJvb2xlYW4gLy8gTWFudWFsbHkgaW5pdGlhbGl6ZSBpbnN0ZWFkIG9mIGF1dG8tZGV0ZWN0aW5nIGRpdnNcclxuICBXaWRnZXRSZXF1ZXN0Q2FsbGJhY2s6ICh3aWRnZXQ6IFdpZGdldCkgPT4gdm9pZFxyXG59XHJcblxyXG4vLyBEZXRhdWx0IG9wdGlvbnNcclxuY29uc3QgZGVmYXVsdE9wdGlvbnM6IFRvbmljUG93T3B0aW9ucyA9IHtcclxuICBBdXRvSW5pdDogdHJ1ZSxcclxuICBXaWRnZXRSZXF1ZXN0Q2FsbGJhY2s6ICh3aWRnZXQ6IFdpZGdldCkgPT4ge30sXHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFRvbmljUG93IHtcclxuICBjb25maWc6IENvbmZpZ1xyXG4gIHN0b3JhZ2U6IFN0b3JhZ2VcclxuICBldmVudHM6IEV2ZW50cyB8IHVuZGVmaW5lZFxyXG4gIG9wdGlvbnM6IFRvbmljUG93T3B0aW9uc1xyXG5cclxuICBjb25zdHJ1Y3RvcihvcHRpb25zOiBUb25pY1Bvd09wdGlvbnMgPSBkZWZhdWx0T3B0aW9ucykge1xyXG4gICAgdGhpcy5vcHRpb25zID0gb3B0aW9uc1xyXG5cclxuICAgIC8vIEltYnVlIG9wdGlvbnNcclxuICAgIGZvciAobGV0IFtvcHRpb25LZXksIG9wdGlvblZhbF0gb2YgT2JqZWN0LmVudHJpZXMob3B0aW9ucykpIHtcclxuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMub3B0aW9ucywgb3B0aW9uS2V5LCB7XHJcbiAgICAgICAgdmFsdWU6IG9wdGlvblZhbCxcclxuICAgICAgICB3cml0YWJsZTogZmFsc2UsXHJcbiAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgY29uc29sZS5sb2coJ2NvbnN0cnVjdGVkJywgdGhpcylcclxuXHJcbiAgICAvLyBTZXQgbmFtZXNwYWNlc1xyXG4gICAgdGhpcy5jb25maWcgPSBuZXcgQ29uZmlnKClcclxuICAgIHRoaXMuc3RvcmFnZSA9IG5ldyBTdG9yYWdlKClcclxuXHJcbiAgICAvLyBTdGFydCB0aGUgVG9uaWNQb3cgc2VydmljZSBhbmQgbG9hZCBtb2R1bGVzXHJcbiAgICBpZiAodGhpcy5vcHRpb25zLkF1dG9Jbml0KSB7XHJcbiAgICAgIC8vIExvYWQgdGhlIFRvbmljUG93IHdpZGdldFxyXG4gICAgICBpZiAoZG9jdW1lbnQucmVhZHlTdGF0ZSA9PT0gJ2NvbXBsZXRlJyB8fCBkb2N1bWVudC5yZWFkeVN0YXRlID09PSAnaW50ZXJhY3RpdmUnKSB7XHJcbiAgICAgICAgLy8gVGhpcyBsb2FkcyBpZiB0aGUgPHNjcmlwdD4gaXMgZHluYW1pY2FsbHkgaW5qZWN0ZWQgaW50byB0aGUgcGFnZVxyXG4gICAgICAgIHRoaXMubG9hZCgpXHJcbiAgICAgICAgdGhpcy5yZWdpc3RlckV2ZW50cygpXHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy8gVGhpcyBsb2FkcyBpZiB0aGUgPHNjcmlwdD4gaXMgaGFyZGNvZGVkIGluIHRoZSBodG1sIHBhZ2UgaW4gdGhlIDxoZWFkPlxyXG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCAoKSA9PiB7XHJcbiAgICAgICAgICB0aGlzLmxvYWQoKVxyXG4gICAgICAgICAgdGhpcy5yZWdpc3RlckV2ZW50cygpXHJcbiAgICAgICAgfSlcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gcmVnaXN0ZXJFdmVudHMgLVJlZ2lzdGVycyBldmVudCBsaXN0ZW5lcnMuIFJ1bnMgb25seSBvbmNlXHJcbiAgcmVnaXN0ZXJFdmVudHMgPSAoKSA9PiB7XHJcbiAgICBpZiAoIXRoaXMuZXZlbnRzKSB7XHJcbiAgICAgIC8vIFJlZ2lzdGVyIGV2ZW50cyBpZiB3ZSBoYXZlIGEgdmFsaWQgc2Vzc2lvblxyXG4gICAgICBsZXQgc2Vzc2lvbiA9IHRoaXMuZ2V0VmlzaXRvclNlc3Npb24oKVxyXG4gICAgICBpZiAoc2Vzc2lvbikge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdyZWdpc3RlcmluZyBzZXNzaW9uJywgc2Vzc2lvbilcclxuICAgICAgICB0aGlzLmV2ZW50cyA9IG5ldyBFdmVudHMoc2Vzc2lvbilcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gc2V0T3JlbyBmb3IgY3JlYXRpbmcgbmV3IG9yZW9zXHJcbiAgc2V0T3JlbyA9IChuYW1lOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcsIGRheXM6IG51bWJlcikgPT4ge1xyXG4gICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKClcclxuICAgIGRhdGUuc2V0VGltZShkYXRlLmdldFRpbWUoKSArIDI0ICogNjAgKiA2MCAqIDEwMDAgKiBkYXlzKVxyXG4gICAgZG9jdW1lbnQuY29va2llID0gYCR7bmFtZX09JHt2YWx1ZX07cGF0aD0vO2V4cGlyZXM9JHtkYXRlLnRvVVRDU3RyaW5nKCl9YFxyXG4gIH1cclxuXHJcbiAgLy8gY2FwdHVyZVZpc2l0b3JTZXNzaW9uIHdpbGwgY2FwdHVyZSB0aGUgc2Vzc2lvbiBhbmQgc3RvcmUgaXRcclxuICAvLyBCdWlsZHMgYSBjb29raWUgc28gaXQncyBzZW50IG9uIHJlcXVlc3RzIGF1dG9tYXRpY2FsbHlcclxuICAvLyBTdG9yZXMgaW4gbG9jYWwgc3RvcmFnZSBmb3IgZWFzeSBhY2Nlc3MgZnJvbSB0aGUgYXBwbGljYXRpb25cclxuICBjYXB0dXJlVmlzaXRvclNlc3Npb24gPSAoY3VzdG9tU2Vzc2lvbklkOiBzdHJpbmcgPSAnJykgPT4ge1xyXG4gICAgbGV0IHNlc3Npb25JZCA9IGN1c3RvbVNlc3Npb25JZFxyXG5cclxuICAgIGlmICgoIWN1c3RvbVNlc3Npb25JZCB8fCAhY3VzdG9tU2Vzc2lvbklkLmxlbmd0aCkgJiYgdHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICAgY29uc3QgdXJsUGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcyh3aW5kb3cubG9jYXRpb24uc2VhcmNoKVxyXG4gICAgICBzZXNzaW9uSWQgPSB1cmxQYXJhbXMuZ2V0KHRoaXMuY29uZmlnLnNlc3Npb25OYW1lKSB8fCAnJ1xyXG4gICAgfVxyXG4gICAgaWYgKHNlc3Npb25JZCAmJiBzZXNzaW9uSWQubGVuZ3RoID4gMCkge1xyXG4gICAgICB0aGlzLnNldE9yZW8odGhpcy5jb25maWcuc2Vzc2lvbk5hbWUsIHNlc3Npb25JZCwgdGhpcy5jb25maWcubWF4U2Vzc2lvbkRheXMpXHJcbiAgICAgIHRoaXMuc3RvcmFnZS5zZXRTdG9yYWdlKFxyXG4gICAgICAgIHRoaXMuY29uZmlnLnNlc3Npb25OYW1lLFxyXG4gICAgICAgIHNlc3Npb25JZCxcclxuICAgICAgICAyNCAqIDYwICogNjAgKiB0aGlzLmNvbmZpZy5tYXhTZXNzaW9uRGF5c1xyXG4gICAgICApXHJcbiAgICAgIHJldHVybiBzZXNzaW9uSWRcclxuICAgIH1cclxuICAgIHJldHVybiBudWxsXHJcbiAgfVxyXG5cclxuICAvLyBnZXRWaXNpdG9yU2Vzc2lvbiB3aWxsIGdldCB0aGUgc2Vzc2lvbiBpZiBpdCBleGlzdHNcclxuICBnZXRWaXNpdG9yU2Vzc2lvbiA9ICgpID0+IHRoaXMuc3RvcmFnZS5nZXRTdG9yYWdlKHRoaXMuY29uZmlnLnNlc3Npb25OYW1lKVxyXG5cclxuICAvLyBsb2FkRGl2cyByZXBsYWNlcyBlYWNoIFRvbmljUG93IGRpdiB3aXRoIGEgY29ycmVzcG9uZGluZyBlbWJlZCB3aWRnZXRcclxuICBsb2FkRGl2cyA9IGFzeW5jICgpID0+IHtcclxuICAgIC8vIEdldCBhbGwgZGl2c1xyXG4gICAgY29uc3QgdG9uaWNEaXZzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSh0aGlzLmNvbmZpZy53aWRnZXREaXZDbGFzcylcclxuXHJcbiAgICAvLyBMb29wIGFsbCBkaXZzIHRoYXQgd2UgZm91bmRcclxuICAgIGZvciAobGV0IGkgPSB0b25pY0RpdnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcclxuICAgICAgLy8gU2V0IHRoZSBkaXZcclxuICAgICAgY29uc3QgdG9uaWNEaXYgPSB0b25pY0RpdnNbaV1cclxuXHJcbiAgICAgIC8vIEdldCB0aGUgd2lkZ2V0IGlkXHJcbiAgICAgIGNvbnN0IHdpZGdldElkID0gdG9uaWNEaXYuZ2V0QXR0cmlidXRlKHRoaXMuY29uZmlnLndpZGdldElkKVxyXG4gICAgICBpZiAoIXdpZGdldElkKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coYCR7d2lkZ2V0SWR9IG5vdCBmb3VuZGApXHJcbiAgICAgICAgY29udGludWVcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gR2V0IHRoZSBjdXN0b20gZW52aXJvbm1lbnQgKHN3aXRjaGluZyBhd2F5IGZyb20gZGVmYXVsdDogcHJvZHVjdGlvbilcclxuICAgICAgY29uc3QgY3VzdG9tRW52aXJvbm1lbnQgPSB0b25pY0Rpdi5nZXRBdHRyaWJ1dGUodGhpcy5jb25maWcuY3VzdG9tRW52aXJvbm1lbnQpXHJcbiAgICAgIHRoaXMuY29uZmlnLnNldEVudmlyb25tZW50KGN1c3RvbUVudmlyb25tZW50IHx8ICdwcm9kdWN0aW9uJylcclxuXHJcbiAgICAgIC8vIEZpcmUgdGhlIHJlcXVlc3QgdG8gbG9hZCB0aGUgd2lkZ2V0IGRhdGFcclxuICAgICAgY29uc3QgcHJvbWlzZSA9IGF3YWl0IGZldGNoKFxyXG4gICAgICAgIGAke3RoaXMuY29uZmlnLmFwaVVybH0vdjEvd2lkZ2V0cy9kaXNwbGF5LyR7d2lkZ2V0SWR9P3Byb3ZpZGVyPWVtYmVkLSR7dGhpcy5jb25maWcudmVyc2lvbn1gXHJcbiAgICAgIClcclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBwcm9taXNlLmpzb24oKVxyXG5cclxuICAgICAgLy8gRmlyZSBjYWxsYmFja1xyXG4gICAgICBjb25zb2xlLmxvZygnZmlyaW5nIGNhbGxiYWNrJylcclxuICAgICAgdGhpcy5vcHRpb25zLldpZGdldFJlcXVlc3RDYWxsYmFjayhyZXNwb25zZSBhcyBXaWRnZXQpXHJcblxyXG4gICAgICAvLyBTZXQgVVJJIGVuY29kZWQgdGl0bGVcclxuICAgICAgY29uc3QgY2FtcGFpZ25UaXRsZSA9IGVuY29kZVVSSUNvbXBvbmVudChyZXNwb25zZS50aXRsZSlcclxuXHJcbiAgICAgIC8vIFNldCB0aGUgSFRNTFxyXG4gICAgICB0b25pY0Rpdi5pbm5lckhUTUwgPSBgXHJcbiAgICA8YSBocmVmPVwiJHtyZXNwb25zZS5saW5rX3VybH0/dXRtX3NvdXJjZT10b25pY3Bvdy13aWRnZXRzJnV0bV9tZWRpdW09d2lkZ2V0JnV0bV9jYW1wYWlnbj0ke3dpZGdldElkfSZ1dG1fY29udGVudD0ke2NhbXBhaWduVGl0bGV9XCIgc3R5bGU9XCJkaXNwbGF5OiBibG9ja1wiPlxyXG4gICAgICA8aW1nIHNyYz1cIiR7cmVzcG9uc2UuaW1hZ2VfdXJsfVwiIFxyXG4gICAgICBpZD1cIiR7d2lkZ2V0SWR9XCJcclxuICAgICAgd2lkdGg9XCIke3Jlc3BvbnNlLndpZHRofVwiIFxyXG4gICAgICBoZWlnaHQ9XCIke3Jlc3BvbnNlLmhlaWdodH1cIiBcclxuICAgICAgYWx0PVwiJHtyZXNwb25zZS50aXRsZX1cIiAvPlxyXG4gICAgPC9hPmBcclxuXHJcbiAgICAgIC8vIFNldCBhZGRpdGlvbmFsIGluZm9ybWF0aW9uXHJcbiAgICAgIHRvbmljRGl2LnNldEF0dHJpYnV0ZSgnZGF0YS13aWR0aCcsIHJlc3BvbnNlLndpZHRoKVxyXG4gICAgICB0b25pY0Rpdi5zZXRBdHRyaWJ1dGUoJ2RhdGEtaGVpZ2h0JywgcmVzcG9uc2UuaGVpZ2h0KVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gTG9hZCB0aGUgVG9uaWNQb3cgc2NyaXB0KHMpIGFuZCBkZWZhdWx0IHNldHRpbmdzXHJcbiAgbG9hZCA9ICgpID0+IHtcclxuICAgIC8vIFdlIG9ubHkgd29yayBpbiBhIGJyb3dzZXJcclxuICAgIGlmICh0eXBlb2Ygd2luZG93ID09PSAndW5kZWZpbmVkJykge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdUb25pY1BvdyBlbWJlZCBvbmx5IHdvcmtzIGluIHRoZSBicm93c2VyJylcclxuICAgICAgcmV0dXJuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gTG9hZCBhbGwgdG9uaWNzIGZvdW5kIG9uIHRoZSBwYWdlIChpZiB3ZSBoYXZlIGRpdilcclxuICAgIGNvbnN0IHRvbmljRGl2cyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUodGhpcy5jb25maWcud2lkZ2V0RGl2Q2xhc3MpXHJcbiAgICBpZiAodG9uaWNEaXZzICYmIHRvbmljRGl2cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIHRoaXMubG9hZERpdnMoKS50aGVuKCgpID0+IHtcclxuICAgICAgICBjb25zb2xlLmxvZygnVG9uaWNQb3cgd2lkZ2V0KHMpIGxvYWRlZCEnKVxyXG4gICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIC8vIFByb2Nlc3MgdmlzaXRvciB0b2tlblxyXG4gICAgY29uc3Qgc2Vzc2lvbiA9IHRoaXMuY2FwdHVyZVZpc2l0b3JTZXNzaW9uKClcclxuXHJcbiAgICAvLyBDYXB0dXJlIGV2ZW50cyBpZiB3ZSBoYXZlIGEgc2Vzc2lvblxyXG4gICAgaWYgKHNlc3Npb24pIHtcclxuICAgICAgdGhpcy5ldmVudHMgPSBuZXcgRXZlbnRzKHNlc3Npb24pXHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG4vLyBUT0RPIC0gaG93IHRmIGRvIHdlIHdlIGF1dG9ydW4gdGhpcyBub3c/XHJcblxyXG4vLyBTZXQgb24gd2luZG93XHJcbjsod2luZG93IGFzIGFueSkuVG9uaWNQb3cgPSBUb25pY1BvdyB8fCB7fVxyXG4iLCIvKiBnbG9iYWwgbG9jYWxTdG9yYWdlICovXHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTdG9yYWdlIHtcclxuICAvKlxyXG4gIHJlbW92ZVN0b3JhZ2U6IHJlbW92ZXMgYSBrZXkgZnJvbSBsb2NhbFN0b3JhZ2UgYW5kIGl0cyBzaWJsaW5nIGV4cGlyYWN5IGtleVxyXG4gIHBhcmFtczpcclxuICAgICAga2V5IDxzdHJpbmc+IDogbG9jYWxTdG9yYWdlIGtleSB0byByZW1vdmVcclxuICByZXR1cm5zOlxyXG4gICAgICA8Ym9vbGVhbj4gOiB0ZWxsaW5nIGlmIG9wZXJhdGlvbiBzdWNjZWVkZWRcclxuICAqL1xyXG4gIHJlbW92ZVN0b3JhZ2UgPSAobmFtZTogc3RyaW5nKSA9PiB7XHJcbiAgICB0cnkge1xyXG4gICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShuYW1lKVxyXG4gICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShgJHtuYW1lfV9leHBpcmVzSW5gKVxyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICBjb25zb2xlLmxvZyhcclxuICAgICAgICBgcmVtb3ZlU3RvcmFnZTogRXJyb3IgcmVtb3Zpbmcga2V5IFske25hbWV9XSBmcm9tIGxvY2FsU3RvcmFnZTogJHtKU09OLnN0cmluZ2lmeShlKX1gXHJcbiAgICAgIClcclxuICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICB9XHJcbiAgICByZXR1cm4gdHJ1ZVxyXG4gIH1cclxuXHJcbiAgLypcclxuICBnZXRTdG9yYWdlOiByZXRyaWV2ZXMgYSBrZXkgZnJvbSBsb2NhbFN0b3JhZ2UgcHJldmlvdXNseSBzZXQgd2l0aCBzZXRTdG9yYWdlKCkuXHJcbiAgcGFyYW1zOlxyXG4gICAgICBrZXkgPHN0cmluZz4gOiBsb2NhbFN0b3JhZ2Uga2V5XHJcbiAgcmV0dXJuczpcclxuICAgICAgPHN0cmluZz4gOiB2YWx1ZSBvZiBsb2NhbFN0b3JhZ2Uga2V5XHJcbiAgICAgIG51bGwgOiBpbiBjYXNlIG9mIGV4cGlyZWQga2V5IG9yIGZhaWx1cmVcclxuICAqL1xyXG4gIGdldFN0b3JhZ2UgPSAoa2V5OiBzdHJpbmcpID0+IHtcclxuICAgIC8vIGVwb2NoIHRpbWUsIGxldHMgZGVhbCBvbmx5IHdpdGggaW50ZWdlclxyXG4gICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKVxyXG5cclxuICAgIC8vIFNldCBleHBpcmF0aW9uIGZvciBzdG9yYWdlXHJcbiAgICBsZXQgZXhwaXJlc1xyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgIGV4cGlyZXMgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShgJHtrZXl9X2V4cGlyZXNgKVxyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICBjb25zb2xlLmxvZyhgZ2V0SXRlbTogZXJyb3IgZ2V0dGluZyBsb2NhbFN0b3JhZ2U6ICR7SlNPTi5zdHJpbmdpZnkoZSl9YClcclxuICAgICAgcmV0dXJuIG51bGxcclxuICAgIH1cclxuXHJcbiAgICBpZiAoZXhwaXJlcyA9PT0gdW5kZWZpbmVkIHx8IGV4cGlyZXMgPT09IG51bGwpIHtcclxuICAgICAgZXhwaXJlcyA9IDBcclxuICAgIH1cclxuXHJcbiAgICAvLyBFeHBpcmVkXHJcbiAgICBpZiAoZXhwaXJlcyA8IG5vdykge1xyXG4gICAgICB0aGlzLnJlbW92ZVN0b3JhZ2Uoa2V5KVxyXG4gICAgICByZXR1cm4gbnVsbFxyXG4gICAgfVxyXG5cclxuICAgIC8vIEdldCB0aGUgZXhpc3RpbmcgaXRlbVxyXG4gICAgdHJ5IHtcclxuICAgICAgcmV0dXJuIGxvY2FsU3RvcmFnZS5nZXRJdGVtKGtleSlcclxuICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgY29uc29sZS5sb2coYGdldFN0b3JhZ2U6IEVycm9yIHJlYWRpbmcga2V5IFske2tleX1dIGZyb20gbG9jYWxTdG9yYWdlOiAke0pTT04uc3RyaW5naWZ5KGUpfWApXHJcbiAgICAgIHJldHVybiBudWxsXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKlxyXG4gIHNldFN0b3JhZ2U6IHdyaXRlcyBhIGtleSBpbnRvIGxvY2FsU3RvcmFnZSBzZXR0aW5nIGEgZXhwaXJlIHRpbWVcclxuICBwYXJhbXM6XHJcbiAgICAgIGtleSA8c3RyaW5nPiAgICAgOiBsb2NhbFN0b3JhZ2Uga2V5XHJcbiAgICAgIHZhbHVlIDxzdHJpbmc+ICAgOiBsb2NhbFN0b3JhZ2UgdmFsdWVcclxuICAgICAgZXhwaXJlcyA8bnVtYmVyPiA6IG51bWJlciBvZiBzZWNvbmRzIGZyb20gbm93IHRvIGV4cGlyZSB0aGUga2V5XHJcbiAgcmV0dXJuczpcclxuICAgICAgPGJvb2xlYW4+IDogdGVsbGluZyBpZiBvcGVyYXRpb24gc3VjY2VlZGVkXHJcbiAgKi9cclxuICBzZXRTdG9yYWdlID0gKGtleTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nLCBleHBpcmVzOiBudW1iZXIgfCBudWxsID0gbnVsbCkgPT4ge1xyXG4gICAgLy8gRXhwaXJlZCB0aW1lXHJcbiAgICBpZiAoZXhwaXJlcykge1xyXG4gICAgICBleHBpcmVzID0gTWF0aC5hYnMoZXhwaXJlcykgLy8gbWFrZSBzdXJlIGl0J3MgcG9zaXRpdmVcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGV4cGlyZXMgPSAyNCAqIDYwICogNjAgLy8gZGVmYXVsdDogc2Vjb25kcyBmb3IgMSBkYXlcclxuICAgIH1cclxuXHJcbiAgICAvLyBNaWxsaSBzZWNvbmRzIHNpbmNlIGVwb2NoIHRpbWUsIGxldHMgZGVhbCBvbmx5IHdpdGggaW50ZWdlclxyXG4gICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKVxyXG4gICAgY29uc3Qgc2NoZWR1bGUgPSBub3cgKyBleHBpcmVzICogMTAwMFxyXG4gICAgdHJ5IHtcclxuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oa2V5LCB2YWx1ZSlcclxuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oYCR7a2V5fV9leHBpcmVzYCwgc2NoZWR1bGUudG9TdHJpbmcoKSlcclxuICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgY29uc29sZS5sb2coYHNldFN0b3JhZ2U6IEVycm9yIHNldHRpbmcga2V5IFske2tleX1dIGluIGxvY2FsU3RvcmFnZTogJHtKU09OLnN0cmluZ2lmeShlKX1gKVxyXG4gICAgICByZXR1cm4gZmFsc2VcclxuICAgIH1cclxuICAgIHJldHVybiB0cnVlXHJcbiAgfVxyXG59XHJcbiIsIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdGlmKF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0pIHtcblx0XHRyZXR1cm4gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuIiwiLy8gc3RhcnR1cFxuLy8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4vLyBUaGlzIGVudHJ5IG1vZHVsZSBpcyByZWZlcmVuY2VkIGJ5IG90aGVyIG1vZHVsZXMgc28gaXQgY2FuJ3QgYmUgaW5saW5lZFxudmFyIF9fd2VicGFja19leHBvcnRzX18gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYwNyk7XG4iXSwic291cmNlUm9vdCI6IiJ9